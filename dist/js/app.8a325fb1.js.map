{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/utils/clamp.js","webpack:///./src/modules/colors.js","webpack:///./src/modules/createScene.js","webpack:///./src/modules/createCamera.js","webpack:///./src/modules/createRenderer.js","webpack:///./src/modules/createSun.js","webpack:///./src/modules/Cube.js","webpack:///./src/modules/materials.js","webpack:///./src/scene/pipeConnection.js","webpack:///./src/scene/pipeCorner.js","webpack:///./src/scene/BottomIsland/chimney.js","webpack:///./src/scene/BottomIsland/fence.js","webpack:///./src/scene/BottomIsland/filter.js","webpack:///./src/scene/BottomIsland/BottomIsland.js","webpack:///./src/scene/fan.js","webpack:///./src/scene/fence.js","webpack:///./src/scene/pine.js","webpack:///./src/scene/MiddleIsland/Windvane.js","webpack:///./src/scene/MiddleIsland/Ladder.js","webpack:///./src/scene/stones.js","webpack:///./src/scene/MiddleIsland/MiddleIsland.js","webpack:///./src/scene/TopIsland/chimney.js","webpack:///./src/scene/TopIsland/House.js","webpack:///./src/scene/TopIsland/TopIsland.js","webpack:///./src/scene/Zeppelin/Balloon.js","webpack:///./src/scene/Zeppelin/hose.js","webpack:///./src/scene/Zeppelin/Fan.js","webpack:///./src/scene/Zeppelin/Tanks.js","webpack:///./src/scene/Zeppelin/Turbine.js","webpack:///./src/scene/Zeppelin/Cabine.js","webpack:///./src/scene/Zeppelin/Zeppelin.js","webpack:///./src/modules/Water.js","webpack:///./src/modules/LampPost.js","webpack:///./src/modules/lightParams.js","webpack:///./src/modules/daytimeParams.js","webpack:///./src/modules/Time.js","webpack:///./src/modules/init.js","webpack:///./src/main.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","clamp","min","val","max","Infinity","Math","colors","lightGreen","darkGreen","lightBrown","darkBronw","darkGrey","darkMetal","lightMetal","white","wood","brick","roof","sky","red","rust","water","balloon","glass","createScene","scene","Scene","createCamera","width","height","aspectRatio","fieldOfView","nearPlane","farPlane","camera","PerspectiveCamera","position","set","rotation","getContext","canvas","WEBGL","isWebGL2Available","createRenderer","antialias","renderer","WebGLRenderer","context","alpha","powerPreference","setSize","setPixelRatio","devicePixelRatio","shadowMap","enabled","createSun","sunLight","DirectionalLight","castShadow","shadow","left","right","top","bottom","near","far","mapSize","Cube","constructor","size","x","y","z","color","random","this","depth","geometry","BoxGeometry","material","MeshPhongMaterial","flatShading","mesh","Mesh","receiveShadow","updateMatrix","materials","green","specular","shininess","side","DoubleSide","transparent","opacity","line","LineBasicMaterial","linewidth","override","wireframe","PipeConnection","isFrontRing","isBackRing","radius","segmentsCount","needMaterial","Geometry","base","CylinderGeometry","PI","merge","matrix","frontRing","TorusGeometry","backRing","segmentGeometry","segment","cos","sin","PipeCorner","isBottomConnection","isTopConnection","Object3D","singleGeometry","arcGeometry","arc","topConnection","bottomConnection","pipeCorner","Chimney","arcShape","Shape","moveTo","absarc","holePath","Path","holes","extrudeSettings","curveSegments","steps","bevelEnabled","ExtrudeGeometry","Fence","isClosed","gridHeight","angle","atan","pillarsGeometry","pillar","anotherPillar","clone","bar","pillars","helixGeometry","vertices","Vector3","helix","Line","lineGeometry","step","diff","tan","grid","LineSegments","add","Filter","linesGeometry","lines","BottomIsland","chimneyCombinedGeometry","chimneysParams","scale","chimney","bigChimneyGeometry","chimneyInner","chimneyOuter","bigChimney","chimneyCombined","pipesParams","fenceParams","fence","filter","Fan","propeller","staticGroupGeometry","pipe","engine","staticGroup","hubGeometry","hub","blades","bladeGeometry","blade","translate","close","centerBoard","topBoard","bottomBoard","paling","Pine","trunkGeometry","trunk","branchesGeometry","R","branchesLevel","branches","Windvane","fan","standGeometry","pillarGeometry","shaft","beam","platform","stand","vaneSupportGeometry","bevel","anotherBevel","vaneSupport","vane","axle","tailShape","tailWidth","tailHeight","lineTo","tail","fanBladesGeometry","fanBlades","fanCenter","Ladder","ladderGeometry","stair","Stones","coordinates","stonesGeometry","stone","MiddleIsland","fans","fansParams","rx","rz","ry","mx","mz","count","fenceWidth","fenceGeometry","fencePerimeter","pine","windvane","ladder","stonesCoordinates","stones","pipesGeometry","type","options","setParams","el","params","pipes","map","spline","CatmullRomCurve3","pipeShape","extrudePath","House","firstFloor","basement","roofLow","roofMiddle","roofTop","roofCombinedGeometry","roofParams","rT","rB","roofPart","roofCombined","chimneyParams","doorShape","door","windowShape","windowGeometry","horizontalFrame","verticalFrame","houseWindow","TopIsland","house","pineParams","sx","sy","sz","Balloon","pointsCount","points","Vector2","LatheGeometry","frameShape","frame","Hose","shape","full","mirrored","engineRadius","engineGeometry","engineMain","engineTopPoints","engineTop","engineTier","sideLeft","sideRight","engineSegment","hose","engineHub","propellerGeometry","bladesHub","bladesGeometry","bladeShape","applyMatrix4","Matrix4","makeRotationX","Tanks","tanksGeometry","tankGeometry","tankRadius","tankCenter","tankTopPoints","tankTop","tankBottom","tankHub","tankLeft","tankRight","tier","Turbine","turbineGeometry","turbineOuterShape","turbineOuter","engineSupport","turbine","propellerHub","Cabine","cabine","turbines","turbineParams","Zeppelin","tanks","hosesGeometry","hosesParams","hoses","Water","verts","v","vprops","waves","ang","amp","speed","verticesNeedUpdate","circle","cirlceRadius","circleSegments","mergeVertices","LampPost","status","light","intensity","distance","decay","baseVertical","baseHorizontal","baseAngle","baseGeometry","lamp","PointLight","lightParams","sunrise","hemisphereLight","ambientLight","midday","sunset","midnight","breakpoints","Time","Date","now","hours","getHours","timeNode","document","getElementById","dayNode","update","init","WIDTH","innerWidth","HEIGHT","innerHeight","addEventListener","aspect","updateProjectionMatrix","container","querySelector","HemisphereLight","AmbientLight","setLights","dayTime","setHex","lampPosts","lampPost","turnLights","bottomIsland","middleIsland","topIsland","zeppelin","islands","river","riverParams","riverPart","lampPostParams","clock","Clock","delta","mousePos","nX","nY","event","clientX","clientY","gyroscope","checkOrientation","beta","gamma","DeviceOrientationEvent","requestPermission","then","permissionState","catch","console","log","time","updateLights","className","easing","draw","getDelta","rotate","rotateFan","moveWaves","render","rafId","requestAnimationFrame","start","stop","cancelAnimationFrame","gui","dat","autoplace","hideable","closed","guiContainer","appendChild","domElement","cameraControls","isOverride","dayTimeGUI","addFolder","open","isIframe","self","e","trusted","includes","origin","controls","process","classList","keyCode","toggle","body"],"mappings":"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","file":"js/app.8a325fb1.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","\nlet clamp = (min, val, max = Infinity) => Math.min(Math.max(min, val), max)\n\nexport default clamp\n","\nexport const colors = {\n\tlightGreen: 0x9db614,\n\tdarkGreen:\t0x59ac27,\n\n\tlightBrown:\t0xffdba9,\n\tdarkBronw:\t0xd0957f,\n\n\tdarkGrey:\t0x72636a,\n\tdarkMetal:\t0x72636a,\n\tlightMetal: 0xdcbbb4,\n\t\n\twhite: \t\t0xfdfcf7,\n\twood:\t\t0xa76e17,\n\tbrick:\t\t0xd6b48e,\n\troof:\t\t0x793156,\n\tsky:\t\t0x80b6dc,\n\n\tred:\t\t0xff0000,\n\trust:\t\t0xb98475,\n\n\twater:\t\t0x80b6dc,\n\n\tballoon:\t0xd9d9d9,\n\tglass:\t\t0xeeeeee\n}","import { Scene, Fog } from 'three';\n\nimport { colors } from './colors';\n\n\nexport default function createScene() {\n\n\tlet scene = new Scene();\n\t// scene.fog = new Fog(colors.sky, 0, 10000);\n\n\treturn scene;\n}","import { PerspectiveCamera } from 'three';\n\n\nexport default function createCamera(width, height) {\n\n\tlet aspectRatio = width / height;\n\tconst fieldOfView = 50;\n\tconst nearPlane = 1;\n\tconst farPlane = 3500;\n\n\tlet camera = new PerspectiveCamera(\n\t\tfieldOfView,\n\t\taspectRatio,\n\t\tnearPlane,\n\t\tfarPlane\n\t);\n\n\tcamera.position.set(0, -350, 2150);\n\tcamera.rotation.set(.20, .036, 0);\n\n\treturn camera;\n}","import { WebGLRenderer } from 'three'\nimport { WEBGL } from 'three/examples/jsm/WebGL.js'\n\nlet getContext = canvas => {\n\tif (WEBGL.isWebGL2Available()) return canvas.getContext('webgl2')\n\n\treturn canvas.getContext('webgl') || canvas.getContext('experimental-webgl')\n}\n\nlet createRenderer = (canvas, width, height, antialias = true) => {\n\n\tlet renderer = new WebGLRenderer({\n\t\tcanvas,\n\t\tcontext: getContext(canvas),\n\t\tantialias: antialias,\n\t\talpha: true,\n\t\tpowerPreference: 'high-performance',\n\t})\n\trenderer.setSize(width, height)\n\trenderer.setPixelRatio(window.devicePixelRatio)\n\n\trenderer.shadowMap.enabled = true\n\t// renderer.shadowMap.renderReverseSided = true\n\n\treturn renderer\n}\n\nexport default createRenderer\n","import { DirectionalLight } from 'three';\n\n\nexport default function createSun() {\n\n\tlet sunLight = new DirectionalLight(0xffffff, .75);\n\n\tsunLight.position.set(-280, 695, 350);\n\tsunLight.castShadow = true;\n\n\tsunLight.shadow.camera.left \t= -800;\n\tsunLight.shadow.camera.right \t= 800;\n\tsunLight.shadow.camera.top \t\t= 800;\n\tsunLight.shadow.camera.bottom \t= -800;\n\tsunLight.shadow.camera.near \t= 1;\n\tsunLight.shadow.camera.far \t\t= 1500;\n\n\tsunLight.shadow.mapSize.width \t= 512;\n\tsunLight.shadow.mapSize.height \t= 512;\n\n\treturn sunLight;\n}","import { Mesh, BoxGeometry, MeshPhongMaterial } from 'three';\n\nimport { colors } from './colors';\n\n\nexport default class Cube {\n\tconstructor(\n\t\tsize = [100, 100, 100],\n\t\tposition = { x: 0, y: 0, z: 0 },\n\t\tcolor = null, name = `cube-${~~(Math.random() * 1000)}`) {\n\n\t\tthis.width \t= size[0];\n\t\tthis.height = size[1];\n\t\tthis.depth \t= size[2];\n\n\t\tthis.color = color;\n\n\t\tthis.geometry = new BoxGeometry(this.width, this.height, this.depth);\n\n\t\tthis.material;\n\n\t\tif (this.color) {\n\t\t\tthis.material = new MeshPhongMaterial({\n\t\t\t\tcolor: this.color,\n\t\t\t\tflatShading: true,\n\t\t\t\t// transparent: true,\n\t\t\t\t// opacity: .6\n\t\t\t});\n\t\t} else {\n\t\t\tthis.material = null\n\t\t};\n\n\t\tthis.mesh = new Mesh(this.geometry, this.material);\n\t\tthis.mesh.castShadow = true;\n\t\tthis.mesh.receiveShadow = true;\n\n\t\tthis.mesh.position.x += position.x;\n\t\tthis.mesh.position.y += position.y;\n\t\tthis.mesh.position.z += position.z;\n\t\t\n\t\tthis.mesh.name = name;\n\n\t\tthis.mesh.updateMatrix();\n\t}\n}","import { MeshPhongMaterial, DoubleSide, LineBasicMaterial } from 'three'\nimport { colors } from './colors'\n\nexport const materials = {\n\twood:\t\tnew MeshPhongMaterial({ color: colors.wood, flatShading: true }),\n\tgreen:\t\tnew MeshPhongMaterial({ color: colors.darkGreen, flatShading: true }),\n\tdarkMetal:\tnew MeshPhongMaterial({ color: colors.darkMetal, specular: 0x050505, shininess: 100 }),\n\n\tlightMetal: new MeshPhongMaterial({\n\t\tcolor: colors.lightMetal,\n\t\tside: DoubleSide,\n\t\tspecular: 0x050505,\n\t\tshininess: 100,\n\t}),\n\n\tglass: new MeshPhongMaterial({\n\t\tcolor: colors.glass,\n\t\tside: DoubleSide,\n\t\ttransparent: true,\n\t\topacity: .5,\n\t\tspecular: 0x050505,\n\t\tshininess: 10000,\n\t}),\n\n\trust: new MeshPhongMaterial({\n\t\tcolor: colors.rust,\n\t\tside: DoubleSide,\n\t\tspecular: 0x050505,\n\t\tshininess: 100,\n\t}),\n\n\tbrick:\tnew MeshPhongMaterial({ color: colors.brick, flatShading: true }),\n\troof:\tnew MeshPhongMaterial({ color: colors.roof, flatShading: true, }),\n\twhite:\tnew MeshPhongMaterial({ color: colors.white, flatShading: true }),\n\tred:\tnew MeshPhongMaterial({ color: colors.red, flatShading: true }),\n\t\n\tballoon: new MeshPhongMaterial({\n\t\tcolor: colors.balloon,\n\t\tflatShading: true,\n\t\tside: DoubleSide,\n\t\t// shadowSide: DoubleSide,\n\t}),\n\n\tline: new LineBasicMaterial({ color: colors.lightMetal, linewidth: 1 }),\n\n\twater: new MeshPhongMaterial({\n\t\tcolor: colors.water,\n\t\tflatShading: true,\n\t\tspecular: 0x050505,\n\t\tshininess: 1000,\n\t\ttransparent: true,\n\t\topacity: .8\n\t}),\n\n\t// for debug\n\toverride: new MeshPhongMaterial({ color: 0xdcb780, wireframe: true })\n}","import {\n\tGeometry,\n\tMesh,\n\tCylinderGeometry,\n\tTorusGeometry\n} from 'three';\n\nimport { materials } from '../modules/materials';\n\n\nexport default class PipeConnection {\n\tconstructor(\n\t\tm = 1,\n\t\tisFrontRing = true,\n\t\tisBackRing = true,\n\t\tradius = 35,\n\t\tsegmentsCount = 16,\n\t\tneedMaterial = false) {\n\n\t\tconst geometry = new Geometry();\n\n\t\tthis.radius = radius;\n\t\tthis.segmentsCount = segmentsCount;\n\t\t\n\t\tconst material = (needMaterial) ? materials.lightMetal : null;\n\n\n\t\t// base\n\t\tconst base = new Mesh(\n\t\t\tnew CylinderGeometry( radius, radius, (24 * m), 16, 1, true )\n\t\t);\n\t\tbase.rotation.y = (2 * Math.PI / 80);\n\t\tbase.updateMatrix();\n\n\t\tgeometry.merge(base.geometry, base.matrix);\n\n\n\t\t// rings\n\t\tif (isFrontRing) {\n\t\t\tconst frontRing = new Mesh(\n\t\t\t\tnew TorusGeometry( radius, 6, 10, 16, (2 * Math.PI) )\n\t\t\t);\n\t\t\tfrontRing.position.y = 12 * m;\n\t\t\tfrontRing.rotation.x = Math.PI / 2;\n\t\t\tfrontRing.updateMatrix();\n\t\t\tgeometry.merge(frontRing.geometry, frontRing.matrix);\n\t\t};\n\n\t\tif (isBackRing) {\n\t\t\tconst backRing = new Mesh(\n\t\t\t\tnew TorusGeometry( radius, 6, 10, 16, (2 * Math.PI) )\n\t\t\t);\n\t\t\tbackRing.position.y = -12 * m;\n\t\t\tbackRing.rotation.x = Math.PI / 2;\n\t\t\tbackRing.updateMatrix();\n\t\t\tgeometry.merge(backRing.geometry, backRing.matrix);\n\t\t};\n\n\t\n\t\t// segments\n\t\tconst segmentGeometry = new CylinderGeometry( 2, 2, (24 * m), 3, 1, true );\n\t\t\n\t\tfor (let i = 0; i < this.segmentsCount; i++) {\n\n\t\t\tconst segment = new Mesh(segmentGeometry);\n\n\t\t\tsegment.position.set(\n\t\t\t\tradius * (Math.cos(i * (2 *Math.PI) / this.segmentsCount)),\n\t\t\t\t0,\n\t\t\t\tradius * (Math.sin(i * (2 * Math.PI) / this.segmentsCount))\n\t\t\t);\n\t\t\tsegment.updateMatrix();\n\n\t\t\tgeometry.merge(segment.geometry, segment.matrix);\n\t\t};\n\n\n\t\tthis.mesh = new Mesh(geometry, material);\n\t\tthis.mesh.name = 'pipe-connection';\n\t}\n}","import {\n\tGeometry,\n\tMesh,\n\tObject3D,\n\tCylinderGeometry,\n\tTorusGeometry\n} from 'three';\n\nimport { materials } from '../modules/materials';\n\nimport PipeConnection from './pipeConnection';\n\n\nexport default class PipeCorner {\n\tconstructor(isBottomConnection = true, isTopConnection = true) {\n\n\t\tthis.mesh = new Object3D();\n\t\tthis.mesh.name = 'pipe-corner';\n\n\t\tconst singleGeometry = new Geometry();\n\n\t\t// pipe radius\n\t\tconst radius = 35;\n\t\n\t\t// arc\n\t\tconst arcGeometry = new TorusGeometry((2 * radius), radius, 16, 16, (Math.PI / 2) );\n\t\tconst arc = new Mesh(arcGeometry);\n\t\tarc.rotation.z = Math.PI / 2;\n\t\tarc.updateMatrix();\n\n\t\tsingleGeometry.merge(arc.geometry, arc.matrix);\n\n\n\t\t// connections\n\t\tif (isTopConnection) {\n\t\t\tconst topConnection = (new PipeConnection()).mesh;\n\t\t\ttopConnection.rotation.z += Math.PI / 2;\n\t\t\ttopConnection.position.y += 2 * radius;\n\t\t\ttopConnection.updateMatrix();\n\n\t\t\tsingleGeometry.merge(topConnection.geometry, topConnection.matrix);\n\t\t};\n\n\t\tif (isBottomConnection) {\n\t\t\tconst bottomConnection = (new PipeConnection()).mesh;\n\t\t\tbottomConnection.position.x -= 2 * radius;\n\t\t\tbottomConnection.updateMatrix();\n\n\t\t\tsingleGeometry.merge(bottomConnection.geometry, bottomConnection.matrix);\n\t\t};\n\n\n\t\t// final mesh\n\t\tconst pipeCorner = new Mesh(singleGeometry, materials.lightMetal);\n\t\tpipeCorner.castShadow = true;\n\t\tpipeCorner.receiveShadow = true;\n\n\t\tthis.mesh = pipeCorner;\n\t}\n}","import { Mesh, Shape, Path, ExtrudeGeometry } from 'three';\n\n// import Cube from '../../modules/Cube';\nimport { materials } from '../../modules/materials';\n\n\nexport default class Chimney {\n\tconstructor() {\n\n\t\tconst arcShape = new Shape();\n\t\tarcShape.moveTo(0, 0);\n\t\tarcShape.absarc(0, 0, 12, 0, Math.PI * 2);\n\n\t\tconst holePath = new Path();\n\t\tholePath.moveTo(0, 0);\n\t\tholePath.absarc(0, 0, 10, 0, Math.PI * 2);\n\t\tarcShape.holes.push( holePath );\n\n\n\t\tconst extrudeSettings = {\n\t\t\tcurveSegments: 8,\n\t\t\tsteps: 1,\n\t\t\tdepth: 1,\n\t\t\tbevelEnabled: false\n\t\t};\n\n\t\t\n\t\tconst geometry = new ExtrudeGeometry(arcShape, extrudeSettings);\n\t\t\n\t\tthis.mesh = new Mesh(geometry, materials.rust);\n\t\tthis.mesh.rotation.x += Math.PI / 2;\n\t\tthis.mesh.castShadow = true;\n\t\tthis.mesh.receiveShadow = true;\n\t\tthis.mesh.name = 'chimney';\n\t}\t\n}","import {\n\tObject3D,\n\tVector3,\n\tGeometry,\n\tLine,\n\tLineSegments,\n\tBoxGeometry,\n\tMesh\n} from 'three';\n\nimport { colors } from '../../modules/colors';\nimport { materials } from '../../modules/materials';\n\n\nexport default class Fence {\n\tconstructor(isClosed = false) {\n\n\t\tthis.mesh = new Object3D;\n\t\tthis.mesh.name = 'fence';\n\n\t\tconst height = 90;\n\t\tconst width = (400 - 10) / 3;\n\n\t\tconst gridHeight = height - 20;\n\t\tconst angle = Math.atan(gridHeight / width);\n\n\n\t\t// pillars\n\t\tconst pillarsGeometry = new Geometry();\n\n\t\tconst pillar = new Mesh(new BoxGeometry(5, height, 5));\n\n\t\tpillarsGeometry.merge(pillar.geometry, pillar.matrix);\n\n\t\tif (isClosed) {\n\t\t\tconst anotherPillar = pillar.clone();\n\t\t\tanotherPillar.position.z += width\n\t\t\tanotherPillar.updateMatrix();\n\t\t\tpillarsGeometry.merge(anotherPillar.geometry, anotherPillar.matrix);\n\t\t};\n\n\t\tconst bar = new Mesh(new BoxGeometry(2, 2, width));\n\t\tbar.position.set(0, (gridHeight / 2) - 10, (width / 2));\n\t\tbar.updateMatrix();\n\n\t\tpillarsGeometry.merge(bar.geometry, bar.matrix);\n\n\t\tconst pillars = new Mesh(pillarsGeometry, materials.darkMetal);\n\t\tpillars.name = 'pillars';\n\t\tpillars.castShadow = true;\n\t\tpillars.receiveShadow = true;\n\n\n\t\t// helix\n\t\tconst helixGeometry = new Geometry();\n\n\t\tfor (let i = 0; i < (width / 2); i++) {\n\n\t\t\thelixGeometry.vertices.push(\n\t\t\t\tnew Vector3(\n\t\t\t\t\t10 * Math.cos(i),\n\t\t\t\t\t10 * Math.sin(i),\n\t\t\t\t\t2 * i\n\t\t\t\t)\n\t\t\t);\n\t\t};\n\n\t\tconst helix = new Line(helixGeometry, materials.line);\n\t\thelix.name = 'helix';\n\n\t\thelix.castShadow = true;\n\t\thelix.receiveShadow = true;\n\t\thelix.position.set(-5, 40, 0);\n\n\n\t\t// mesh\n\t\tconst lineGeometry = new Geometry();\n\t\tconst step = width / 5;\n\n\t\tfor (let i = 0; i < width; i+=step) {\n\n\t\t\tconst diff = width - i;\n\n\t\t\tlineGeometry.vertices.push( new Vector3(0, 0, i) );\n\t\t\tlineGeometry.vertices.push( new Vector3(0, diff * Math.tan(angle), width) );\n\n\t\t};\n\n\t\tfor (let i = width; i > 0; i-=step) {\n\t\t\t\n\t\t\tconst diff = width - i;\n\n\t\t\tlineGeometry.vertices.push( new Vector3(0, gridHeight, diff) );\n\t\t\tlineGeometry.vertices.push( new Vector3(0, gridHeight - diff * Math.tan(angle), 0) );\n\n\t\t};\n\n\t\tfor (let i = 0; i < width; i+=step) {\n\t\t\t\n\t\t\tconst diff = width - i;\n\n\t\t\tlineGeometry.vertices.push( new Vector3(0, 0, diff) );\n\t\t\tlineGeometry.vertices.push( new Vector3(0, diff * Math.tan(angle), 0) );\n\n\t\t};\n\n\t\tfor (let i = 0; i < width; i+=step) {\n\t\t\t\n\t\t\tconst diff = width - i;\n\n\t\t\tlineGeometry.vertices.push( new Vector3(0, gridHeight, i) );\n\t\t\tlineGeometry.vertices.push( new Vector3(0, gridHeight - (diff * Math.tan(angle)), width) );\n\n\t\t};\n\n\t\tconst grid = new LineSegments(lineGeometry, materials.line);\n\t\tgrid.position.y -= (height / 2);\n\t\tgrid.castShadow = true;\n\t\tgrid.receiveShadow = true;\n\t\tgrid.name = 'grid';\n\n\n\t\t// final\n\t\tthis.mesh.add(\n\t\t\tpillars,\n\t\t\thelix,\n\t\t\tgrid\n\t\t);\n\t}\n}","import {\n\tObject3D,\n\tVector3,\n\tGeometry,\n\tLineSegments,\n\tBoxGeometry,\n\tMesh\n} from 'three';\n\n\nimport { materials } from '../../modules/materials';\n\n\nexport default class Filter {\n\tconstructor() {\n\n\t\tthis.mesh = new Object3D();\n\t\tthis.mesh.name = 'filter';\n\n\n\t\t// pillars\n\t\tconst pillarsGeometry = new Geometry();\n\n\t\tconst pillar = new Mesh(new BoxGeometry(5, 30, 390));\n\n\t\tconst anotherPillar = pillar.clone();\n\t\tanotherPillar.position.x -= 100;\n\t\tanotherPillar.updateMatrix();\n\n\t\tpillarsGeometry.merge(pillar.geometry, pillar.matrix);\n\t\tpillarsGeometry.merge(anotherPillar.geometry, anotherPillar.matrix);\n\n\t\tconst pillars = new Mesh(pillarsGeometry, materials.rust);\n\t\tpillars.castShadow = true;\n\t\tpillars.receiveShadow = true;\n\n\n\t\t// filter (lines)\n\t\tconst linesGeometry = new Geometry();\n\n\t\tfor (let i = 0; i < 4; i++) {\n\t\t\t\n\t\t\tlet y = i * 4;\n\n\t\t\tlinesGeometry.vertices.push( new Vector3(0, y, -40) );\n\t\t\tlinesGeometry.vertices.push( new Vector3(-100, y, -40 ) );\n\t\t};\n\n\t\tconst lines = new LineSegments(linesGeometry, materials.line);\n\t\tlines.castShadow = true;\n\t\tlines.receiveShadow = true;\n\n\n\t\tthis.mesh.add(\n\t\t\tpillars,\n\t\t\tlines\n\t\t);\n\t}\n}","import { Mesh, Object3D, Geometry, CylinderGeometry } from 'three';\n\nimport Cube from '../../modules/Cube';\nimport { colors } from '../../modules/colors';\nimport { materials } from '../../modules/materials';\nimport PipeCorner from '../pipeCorner';\n\nimport Chimney from './chimney';\nimport Fence from './fence';\nimport Filter from './filter';\n\n\nexport default class BottomIsland {\n\tconstructor() {\n\n\t\tthis.mesh = new Object3D();\n\t\tthis.mesh.name = 'bottom-island';\n\n\t\t// big cube\n\t\tthis.mesh.add(\n\t\t\t(new Cube(\n\t\t\t\t[400, 400, 400],\n\t\t\t\t{x: 0, y: 0, z: 0},\n\t\t\t\tcolors.darkGrey)\n\t\t\t).mesh\n\t\t);\n\t\tthis.mesh.position.set(0, -400, 400);\n\n\n\t\t// chimney\n\t\tconst chimneyCombinedGeometry = new Geometry();\n\n\t\tconst chimneysParams = [\n\t\t\t{x: 120, y: 350, z: -120, scale: 150},\n\t\t\t{x: 135, y: 270, z: -90, scale: 70},\n\t\t\t{x: 95,  y: 245, z: -70, scale: 50},\n\t\t\t{x: 80,  y: 240, z: 70,  scale: 40},\n\t\t\t{x: 90,  y: 230, z: 100, scale: 30},\n\t\t\t{x: 120, y: 220, z: 80,  scale: 20},\n\t\t\t{x: -130, y: 320, z: -110, scale: 140},\n\t\t\t{x: -125, y: 270, z: -70, scale: 70},\n\t\t\t{x: -140, y: 500, z: 90, scale: 200}\n\t\t];\n\t\t\n\n\t\tfor (let i = 0; i < chimneysParams.length; i++) {\n\t\t\t\n\t\t\tconst chimney = (new Chimney()).mesh;\n\t\t\tchimney.position.set(\n\t\t\t\tchimneysParams[i].x,\n\t\t\t\tchimneysParams[i].y,\n\t\t\t\tchimneysParams[i].z,\n\t\t\t);\n\t\t\tchimney.scale.z = chimneysParams[i].scale;\n\t\t\tchimney.updateMatrix();\n\n\t\t\tchimneyCombinedGeometry.merge(chimney.geometry, chimney.matrix);\n\t\t};\n\n\n\t\t// big chimney!\n\t\tconst bigChimneyGeometry = new Geometry();\n\n\t\tconst chimneyInner = new Mesh(\n\t\t\tnew CylinderGeometry(40, 40, 70, 6, 1)\n\t\t);\n\t\tchimneyInner.position.set(0, -50, 0);\n\t\tchimneyInner.updateMatrix();\n\n\t\tconst chimneyOuter = (new Chimney()).mesh;\n\t\tchimneyOuter.scale.set(3.5, 3.5, 150); // XZY\n\t\tchimneyOuter.updateMatrix();\n\n\t\tbigChimneyGeometry.merge(chimneyInner.geometry, chimneyInner.matrix);\n\t\tbigChimneyGeometry.merge(chimneyOuter.geometry, chimneyOuter.matrix);\n\n\t\tconst bigChimney = new Mesh(bigChimneyGeometry, materials.rust);\n\n\t\tbigChimney.position.set(-125, 325, 90);\n\t\tbigChimney.updateMatrix();\n\n\t\t\n\t\tchimneyCombinedGeometry.merge(bigChimney.geometry, bigChimney.matrix);\n\n\t\tconst chimneyCombined = new Mesh(chimneyCombinedGeometry, materials.rust);\n\t\tchimneyCombined.castShadow = true;\n\t\tchimneyCombined.receiveShadow = true;\n\n\t\tthis.mesh.add(chimneyCombined);\n\n\n\n\t\t// pipe corners\n\t\tconst pipesParams = [\n\t\t\t{\n\t\t\t\tposition: { x: 0, y: 170, z: 195 },\n\t\t\t\trotation: { x: 0, y: (Math.PI / 2), z: 0 }\n\t\t\t},\n\t\t\t{\n\t\t\t\tposition: { x: 0, y: 0, z: 195 },\n\t\t\t\trotation: { x: 0, y: (Math.PI / 2), z: Math.PI }\n\t\t\t},\n\t\t\t{\n\t\t\t\tposition: { x: 215, y: -75, z: 10 },\n\t\t\t\trotation: { x: (Math.PI / 2), y: (Math.PI / 2), z: 0 }\n\t\t\t},\n\t\t\t{\n\t\t\t\tposition: { x: 215, y: -75, z: -20 },\n\t\t\t\trotation: { x: (Math.PI / 2), y: Math.PI, z: 0 }\n\t\t\t}\n\t\t];\n\n\t\tfor (let i = 0; i < pipesParams.length; i++) {\n\n\t\t\tconst pipeCorner = (new PipeCorner()).mesh;\n\t\t\t\n\t\t\tpipeCorner.position.set(\n\t\t\t\tpipesParams[i].position.x,\n\t\t\t\tpipesParams[i].position.y,\n\t\t\t\tpipesParams[i].position.z\n\t\t\t);\n\n\t\t\tpipeCorner.rotation.set(\n\t\t\t\tpipesParams[i].rotation.x,\n\t\t\t\tpipesParams[i].rotation.y,\n\t\t\t\tpipesParams[i].rotation.z,\n\t\t\t\t'ZYX'\n\t\t\t);\n\n\t\t\tthis.mesh.add(pipeCorner);\n\t\t};\n\n\n\t\t// fence\n\t\tconst fenceParams = [\n\t\t\t{\n\t\t\t\tposition: { x: 195, y: 245, z: -195 },\n\t\t\t\trotation: { x: 0, y: 0, z: 0 }\n\t\t\t},\n\t\t\t{\n\t\t\t\tposition: { x: 195, y: 245, z: (-195 + 130) },\n\t\t\t\trotation: { x: 0, y: 0, z: 0 }\n\t\t\t},\n\t\t\t{\n\t\t\t\tposition: { x: 195, y: 245, z: (-195 + 130 * 2) },\n\t\t\t\trotation: { x: 0, y: 0, z: 0 }\n\t\t\t},\n\n\t\t\t{\n\t\t\t\tposition: { x: 195, y: 245, z: 195 },\n\t\t\t\trotation: { x: 0, y: (-Math.PI / 2), z: 0 },\n\t\t\t\tisClosed: true\n\t\t\t},\n\t\t\t{\n\t\t\t\tposition: { x: (195 - 130 * 2), y: 245, z: 195 },\n\t\t\t\trotation: { x: 0, y: (-Math.PI / 2), z: 0 },\n\t\t\t\tisClosed: true\n\t\t\t},\n\n\t\t\t{\n\t\t\t\tposition: { x: -195, y: 245, z: -195 },\n\t\t\t\trotation: { x: 0, y: 0, z: 0 }\n\t\t\t},\n\t\t\t{\n\t\t\t\tposition: { x: -195, y: 245, z: (-195 + 130) },\n\t\t\t\trotation: { x: 0, y: 0, z: 0 }\n\t\t\t},\n\t\t\t{\n\t\t\t\tposition: { x: -195, y: 245, z: (-195 + 130 * 2) },\n\t\t\t\trotation: { x: 0, y: 0, z: 0 }\n\t\t\t},\n\t\t];\n\n\t\tfor (let i = 0; i < fenceParams.length; i++) {\n\t\t\t\n\n\t\t\tconst fence = (new Fence(fenceParams[i].isClosed)).mesh;\n\n\t\t\tfence.position.set(\n\t\t\t\tfenceParams[i].position.x,\n\t\t\t\tfenceParams[i].position.y,\n\t\t\t\tfenceParams[i].position.z\n\t\t\t);\n\n\t\t\tfence.rotation.set(\n\t\t\t\tfenceParams[i].rotation.x,\n\t\t\t\tfenceParams[i].rotation.y,\n\t\t\t\tfenceParams[i].rotation.z\n\t\t\t);\n\n\t\t\tthis.mesh.add(fence);\n\t\t};\n\n\n\t\t// water filter\n\t\tconst filter = (new Filter()).mesh;\n\t\tfilter.position.set(50, 215, -5);\n\n\t\tthis.mesh.add(filter);\n\t}\n}","import { Geometry, Mesh, Object3D, CylinderGeometry, BoxGeometry } from 'three';\n\nimport { materials } from '../modules/materials';\n\n\nexport default class Fan {\n\tconstructor() {\n\n\t\tthis.mesh = new Object3D();\n\t\tthis.mesh.name = 'fan';\n\n\t\tconst staticGroupGeometry = new Geometry();\n\n\n\t\tconst base = new Mesh(\n\t\t\tnew CylinderGeometry(8, 8, 10, 6, 1)\n\t\t);\n\n\n\t\tconst pipe = new Mesh(\n\t\t\tnew CylinderGeometry(5, 5, 400, 6, 1)\n\t\t);\n\n\n\t\tconst engine = new Mesh(\n\t\t\tnew CylinderGeometry(25, 25, 50, 8, 1)\n\t\t);\n\t\tengine.rotation.x += Math.PI / 2;\n\t\tengine.position.y += 200;\n\t\tengine.updateMatrix();\n\n\n\t\tstaticGroupGeometry.merge(base.geometry, base.matrix);\n\t\tstaticGroupGeometry.merge(pipe.geometry, pipe.matrix);\n\t\tstaticGroupGeometry.merge(engine.geometry, engine.matrix);\n\n\t\tconst staticGroup = new Mesh(staticGroupGeometry, materials.darkMetal);\n\t\tstaticGroup.castShadow = true;\n\t\tstaticGroup.receiveShadow = true;\n\n\t\n\t\t// propeller\n\t\tconst propeller = new Object3D();\n\n\t\tconst hubGeometry = new CylinderGeometry(10, 10, 30, 6, 1);\n\t\tconst hub = new Mesh(hubGeometry, materials.darkMetal);\n\t\thub.receiveShadow = true;\n\t\thub.castShadow = true;\n\t\thub.position.z += 30;\n\t\thub.rotation.x = Math.PI / 2\n\n\t\t// blades\n\t\tlet blades = [];\n\t\tconst bladeGeometry = new BoxGeometry(20, 120, 2);\n\n\t\tfor (let i = 0; i < 3; i++) {\n\t\t\tconst blade = new Mesh(bladeGeometry, materials.white);\n\n\t\t\tblade.geometry.translate( 0, 120 / 6, 0 );\n\n\t\t\tblade.geometry.vertices[4].y += 5;\n\t\t\tblade.geometry.vertices[4].z -= 1;\n\t\t\tblade.geometry.vertices[5].y += 5;\n\t\t\tblade.geometry.vertices[5].z -= 1;\n\n\t\t\tblade.rotation.z = i * (2 * Math.PI / 3);\n\t\t\tblade.position.z += 40;\n\n\t\t\tblade.castShadow = true;\n\t\t\tblade.receiveShadow = true;\n\n\t\t\tblades.push(blade);\n\t\t};\n\n\n\t\tpropeller.position.y += 200;\n\t\tpropeller.add(hub, ...blades);\n\n\t\tthis.propeller = propeller; // global for animation\n\t\n\t\t// final\n\t\tthis.mesh.add(staticGroup, propeller);\n\t}\n\n\trotate = (value) => {\n\t\tthis.propeller.rotation.z += value;\n\t}\n}","import { Geometry, Mesh } from 'three';\n\nimport Cube from '../modules/Cube';\n\nimport { materials } from '../modules/materials';\n\n\nexport default class Fence {\n\tconstructor(close = false) {\n\n\t\tconst singleGeometry = new Geometry();\n\n\n\t\tconst centerBoard = new Cube(\n\t\t\t[10, 20, 4],\n\t\t\t{x: 0, y: 0, z: 0}\n\t\t);\n\t\tcenterBoard.mesh.updateMatrix();\n\n\t\tconst topBoard = new Cube(\n\t\t\t[28, 4, 2],\n\t\t\t{x: -((28 / 2) + (10 / 2)), y: (10 - 4 / 2), z: 0}\n\t\t);\n\t\ttopBoard.mesh.updateMatrix();\n\n\t\tconst bottomBoard = new Cube(\n\t\t\t[28, 4, 2],\n\t\t\t{x: -((28 / 2) + (10 / 2)), y: -3, z: 0}\n\t\t);\n\t\tbottomBoard.mesh.updateMatrix();\n\n\t\tconst paling = new Cube(\n\t\t\t[10, 6, 4],\n\t\t\t{x: 0, y: 13, z: 0}\n\t\t);\n\n\t\tpaling.mesh.geometry.vertices[0].x -= 5;\n\t\tpaling.mesh.geometry.vertices[1].x -= 5;\n\t\tpaling.mesh.geometry.vertices[4].x += 5;\n\t\tpaling.mesh.geometry.vertices[5].x += 5;\n\t\tpaling.mesh.updateMatrix();\n\n\t\tsingleGeometry.merge(bottomBoard.mesh.geometry, bottomBoard.mesh.matrix);\n\t\tsingleGeometry.merge(centerBoard.mesh.geometry, centerBoard.mesh.matrix);\n\t\tsingleGeometry.merge(topBoard.mesh.geometry, topBoard.mesh.matrix);\n\t\tsingleGeometry.merge(paling.mesh.geometry, paling.mesh.matrix);\n\n\n\t\tthis.width = 38;\n\n\t\tthis.mesh = new Mesh(\n\t\t\tsingleGeometry,\n\t\t\tmaterials.wood\n\t\t);\n\n\t\tthis.mesh.position.y += 10;\n\t}\n}","import { Geometry, Mesh, Object3D, CylinderGeometry  } from 'three';\n\nimport { materials } from '../modules/materials';\n\n\nexport default class Pine {\n\tconstructor(scale = [1, 1, 1], rotation = 0) {\n\n\t\tthis.mesh = new Object3D();\n\t\tthis.mesh.name = 'pine';\n\n\t\t// tree trunk\n\t\tconst trunkGeometry = new CylinderGeometry(8, 8, 15, 10, 1);\n\n\t\tconst trunk = new Mesh(trunkGeometry, materials.wood);\n\t\ttrunk.castShadow = true;\n\t\ttrunk.receiveShadow = true;\n\t\ttrunk.position.y += 7.5;\n\n\n\t\t// branches\n\t\tconst branchesGeometry = new Geometry();\n\n\t\tfor (let i = 1; i <= 7; i++) {\n\t\t\tlet R = 45 - (i * 5); \n\t\t\tconst branchesLevel = new Mesh(new CylinderGeometry((R - 10), R, 10, 6, 1));\n\n\t\t\tbranchesLevel.position.y += 10 + (i * 70) / 7;\n\n\t\t\tbranchesLevel.updateMatrix();\n\n\t\t\tbranchesGeometry.merge(branchesLevel.geometry, branchesLevel.matrix);\n\t\t};\n\t\tconst branches = new Mesh(branchesGeometry, materials.green);\n\t\tbranches.receiveShadow = true;\n\t\tbranches.castShadow = true;\n\n\n\t\tthis.mesh.scale.x = scale[0];\n\t\tthis.mesh.scale.y = scale[1];\n\t\tthis.mesh.scale.z = scale[2];\n\n\t\tthis.mesh.rotation.y = rotation;\n\n\t\tthis.mesh.add(\n\t\t\ttrunk,\n\t\t\tbranches\n\t\t);\n\n\t}\n}","import { Geometry, Mesh, Object3D, CylinderGeometry, Shape, ExtrudeGeometry } from 'three';\n\nimport Cube from '../../modules/Cube';\nimport { materials } from '../../modules/materials';\n\n\nexport default class Windvane {\n\tconstructor() {\n\n\t\tthis.mesh = new Object3D();\n\t\tthis.mesh.name = 'windwane';\n\n\n\t\tconst standGeometry = new Geometry();\n\n\n\t\tconst pillarGeometry = new Geometry();\n\t\n\t\t{\n\t\t\tconst shaft\t= new Cube(\n\t\t\t\t[20, 200, 15],\n\t\t\t\t{x: 0, y: 100, z: 0}\n\t\t\t).mesh;\n\t\n\t\t\tshaft.geometry.vertices[0].x -= 5;\n\t\t\tshaft.geometry.vertices[0].z -= 5;\n\t\t\tshaft.geometry.vertices[1].x -= 5;\n\t\t\tshaft.geometry.vertices[1].z += 5;\n\t\t\tshaft.geometry.vertices[4].x += 5;\n\t\t\tshaft.geometry.vertices[4].z += 5;\n\t\t\tshaft.geometry.vertices[5].x += 5;\n\t\t\tshaft.geometry.vertices[5].z -= 5;\n\n\t\t\tshaft.updateMatrix();\n\t\t\t\n\t\t\tpillarGeometry.merge(shaft.geometry, shaft.matrix);\n\t\n\t\t\t// beams\n\t\t\tfor (let j = 0; j < 4; j++) {\n\t\t\t\tconst beam = new Cube(\n\t\t\t\t\t[65, 10, 5],\n\t\t\t\t\t{\n\t\t\t\t\t\tx: -25,\n\t\t\t\t\t\ty: 30 + (j * 40),\n\t\t\t\t\t\tz: 0\n\t\t\t\t\t}\n\t\t\t\t).mesh;\n\t\n\t\t\t\tbeam.rotation.z += (Math.PI / 4) * ((j % 2 === 0) ? (-1) : 1);\n\t\t\t\tbeam.updateMatrix();\n\t\n\t\t\t\tpillarGeometry.merge(beam.geometry, beam.matrix);\n\t\t\t};\n\t\t};\n\n\t\tfor (let i = 0; i < 4; i++) {\n\n\t\t\tconst pillar = new Mesh(pillarGeometry, materials.wood);\n\t\t\tpillar.position.x += 40 * Math.cos(i * Math.PI / 2);\n\t\t\tpillar.position.z += 40 * Math.sin(i * Math.PI / 2);\n\n\t\t\tpillar.rotation.y += (Math.PI / 4) - i * (Math.PI / 2);\n\n\t\t\tpillar.updateMatrix();\n\n\t\t\tstandGeometry.merge(pillar.geometry, pillar.matrix);\n\t\t};\n\n\n\t\tconst platform = new Cube(\n\t\t\t[80, 10, 80],\n\t\t\t{x: 0, y: 200, z: 0},\n\t\t).mesh;\n\t\tplatform.rotation.y -= Math.PI / 4;\n\t\tplatform.updateMatrix();\n\n\t\tstandGeometry.merge(platform.geometry, platform.matrix);\n\n\n\t\t// \n\t\tconst stand = new Mesh(standGeometry, materials.wood);\n\t\tstand.name = 'stand';\n\t\tstand.castShadow = true;\n\t\tstand.receiveShadow = true;\n\t\tstand.rotation.y += Math.PI / 4;\n\n\n\t\t// \n\t\tconst vaneSupportGeometry = new Geometry();\n\n\t\t{\n\t\t\tconst bevel = new Mesh(new CylinderGeometry(2, 2, 60, 6, 1));\n\t\t\tbevel.rotation.z = Math.PI / 6;\n\t\t\tbevel.position.set(15, 230, 0);\n\t\t\tbevel.updateMatrix();\n\n\t\t\tconst anotherBevel = bevel.clone();\n\t\t\tanotherBevel.rotation.z = -Math.PI / 6;\n\t\t\tanotherBevel.position.x = -15;\n\t\t\tanotherBevel.updateMatrix();\n\n\t\t\tconst hub = new Mesh(new CylinderGeometry(4, 4, 6, 6, 1));\n\t\t\thub.position.set(0, 255, 0);\n\t\t\thub.updateMatrix();\n\n\t\t\tvaneSupportGeometry.merge(bevel.geometry, bevel.matrix);\n\t\t\tvaneSupportGeometry.merge(anotherBevel.geometry, anotherBevel.matrix);\n\t\t\tvaneSupportGeometry.merge(hub.geometry, hub.matrix);\n\t\t};\n\n\t\tconst vaneSupport = new Mesh(vaneSupportGeometry, materials.lightMetal);\n\t\tvaneSupport.castShadow = true;\n\t\tvaneSupport.receiveShadow = true;\n\n\n\t\tconst vane = new Object3D();\n\n\t\t{\n\t\t\t// axle\n\t\t\tconst axle = new Mesh(new CylinderGeometry(2, 2, 100, 6, 1), materials.lightMetal);\n\t\t\taxle.position.set(0, 260, 0);\n\t\t\taxle.rotation.x += Math.PI / 2;\n\t\t\taxle.receiveShadow = true;\n\t\t\taxle.castShadow = true;\n\n\n\t\t\t// hub\n\t\t\tconst hub = new Mesh(new CylinderGeometry(3, 3, 5, 6, 1), materials.lightMetal);\n\t\t\thub.position.set(0, 260, 0);\n\t\t\thub.receiveShadow = true;\n\t\t\thub.castShadow = true;\n\n\n\t\t\t// tail\n\t\t\tconst tailShape = new Shape();\n\t\t\tconst tailWidth = 36;\n\t\t\tconst tailHeight = 16;\n\t\t\ttailShape.moveTo(0, tailHeight / 2);\n\t\t\ttailShape.lineTo(tailWidth / 4, tailHeight);\n\t\t\ttailShape.lineTo(tailWidth, tailHeight);\n\t\t\ttailShape.lineTo(tailWidth - tailWidth / 4, tailHeight / 2);\n\t\t\ttailShape.lineTo(tailWidth, 0);\n\t\t\ttailShape.lineTo(tailWidth / 4, 0);\n\t\t\ttailShape.moveTo(0, tailHeight / 2);\n\n\t\t\tconst extrudeSettings = {\n\t\t\t\tsteps: 2,\n\t\t\t\tdepth: 4,\n\t\t\t\tbevelEnabled: false\n\t\t\t};\n\n\t\t\tconst tail = new Mesh(\n\t\t\t\tnew ExtrudeGeometry(tailShape, extrudeSettings),\n\t\t\t\tmaterials.red\n\t\t\t);\n\t\t\ttail.castShadow = true;\n\t\t\ttail.receiveShadow = true;\n\n\t\t\ttail.position.set(-2, 260 - (tailHeight / 2), -25);\n\t\t\ttail.rotation.y = Math.PI / 2;\n\n\n\t\t\t// windvane fan\n\t\t\tconst fan = new Object3D();\n\n\n\t\t\tconst fanBladesGeometry = new Geometry();\n\n\t\t\tfor (let i = 0; i < 12; i++) {\n\t\t\t\tconst blade = new Cube(\n\t\t\t\t\t[45, 2, 1],\n\t\t\t\t\t{\n\t\t\t\t\t\tx: 4 * Math.cos(i * (Math.PI / 6)),\n\t\t\t\t\t\ty: 4 * Math.sin(i * (Math.PI / 6)),\n\t\t\t\t\t\tz: 0\n\t\t\t\t\t}\n\t\t\t\t).mesh;\n\t\t\t\tblade.geometry.translate(20, 0, 0);\n\n\t\t\t\tblade.geometry.vertices[1].z -= 4;\n\t\t\t\tblade.geometry.vertices[1].y += 10;\n\n\t\t\t\tblade.rotation.z += i * Math.PI / 6;\n\t\t\t\tblade.updateMatrix();\n\n\t\t\t\tfanBladesGeometry.merge(blade.geometry, blade.matrix);\n\t\t\t};\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  // temp material\n\t\t\tconst fanBlades = new Mesh(fanBladesGeometry, materials.lightMetal);\n\t\t\tfanBlades.castShadow = true;\n\t\t\tfanBlades.receiveShadow = true;\n\n\n\t\t\t// fan center\n\t\t\tconst fanCenter = new Mesh(\n\t\t\t\tnew CylinderGeometry(4, 4, 4, 6, 1),\n\t\t\t\tmaterials.darkMetal\n\t\t\t);\n\t\t\tfanCenter.rotation.x = Math.PI / 2;\n\t\t\tfanCenter.castShadow = true;\n\t\t\tfanCenter.receiveShadow = true;\n\n\n\t\t\tfan.add(fanBlades, fanCenter);\n\t\t\tfan.position.set(0, 260, 45);\n\t\t\tthis.fan = fan;\n\n\t\t\t// final\n\t\t\tvane.add(axle, hub, tail, fan);\n\t\t};\n\n\t\tthis.vane = vane;\n\n\n\t\t// final\n\t\tthis.mesh.add(\n\t\t\tstand,\n\t\t\tvaneSupport,\n\t\t\tvane\n\t\t);\n\t}\n\n\trotateFan = (value) => {\n\t\tthis.fan.rotation.z += value;\n\t}\n}","import { Geometry, Mesh } from 'three';\n\nimport Cube from '../../modules/Cube';\nimport { materials } from '../../modules/materials';\n\n\nexport default class Ladder {\n\tconstructor() {\n\n\t\tconst ladderGeometry = new Geometry();\n\n\t\tconst pillar = new Cube(\n\t\t\t\t[5, 410, 5],\n\t\t\t\t{x: 0, y: 205, z: 0}\n\t\t).mesh;\n\n\t\tladderGeometry.merge(pillar.geometry, pillar.matrix);\n\n\t\tconst anotherPillar = pillar.clone();\n\t\tanotherPillar.position.z -= 30;\n\t\tanotherPillar.updateMatrix();\n\n\t\tladderGeometry.merge(anotherPillar.geometry, anotherPillar.matrix);\n\n\n\t\t// stairs\n\t\tfor (let i = 0; i < 40; i++) {\n\t\t\tconst stair = new Cube(\n\t\t\t\t[2, 2, 30],\n\t\t\t\t{x: 0, y: (i * 10) + 10, z: -15}\n\t\t\t).mesh;\n\n\t\t\tladderGeometry.merge(stair.geometry, stair.matrix);\n\t\t};\n\n\n\t\tthis.mesh = new Mesh(ladderGeometry, materials.wood);\n\t\tthis.mesh.castShadow = true;\n\t\tthis.mesh.receiveShadow = true;\n\n\t}\n};","import { Geometry, Mesh } from 'three';\n\nimport Cube from '../modules/Cube';\nimport { materials } from '../modules/materials';\n\n\nexport default class Stones {\n\tconstructor(coordinates = [ [0, 0, 0] ] ) {\n\n\t\tconst stonesGeometry = new Geometry();\n\n\t\tfor (let i = 0; i < coordinates.length; i++) {\n\t\t\tconst stone = new Cube(\n\t\t\t\t[30, 40, 30],\n\t\t\t\t{\n\t\t\t\t\tx: coordinates[i][0],\n\t\t\t\t\ty: coordinates[i][1],\n\t\t\t\t\tz: coordinates[i][2]\n\t\t\t\t}\n\t\t\t).mesh;\n\n\t\t\tstone.rotation.set(\n\t\t\t\tMath.random() * (2 * Math.PI),\n\t\t\t\tMath.random() * (2 * Math.PI),\n\t\t\t\tMath.random() * (2 * Math.PI)\n\t\t\t);\n\t\t\tstone.updateMatrix();\n\n\t\t\tstonesGeometry.merge(stone.geometry, stone.matrix);\n\t\t};\n\n\n\t\tthis.mesh = new Mesh(\n\t\t\tstonesGeometry,\n\t\t\tmaterials.lightMetal\n\t\t);\n\n\t\tthis.mesh.castShadow = true;\n\t\tthis.mesh.receiveShadow = true;\n\t}\n};","import { Object3D, Geometry, Mesh, CylinderGeometry } from 'three';\n\nimport Cube from '../../modules/Cube';\nimport Fan from '../fan';\nimport Fence from '../fence';\nimport Pine from '../pine';\nimport Windvane from './Windvane';\nimport Ladder from './Ladder';\nimport Stones from '../stones';\n\nimport PipeCorner from '../pipeCorner';\nimport PipeConnection from '../pipeConnection';\n\nimport { colors } from '../../modules/colors';\nimport { materials } from '../../modules/materials';\n\n\nexport default class MiddleIsland {\n\tconstructor() {\n\n\t\tthis.mesh = new Object3D();\n\t\tthis.mesh.name = 'middle-island';\n\n\n\t\t// big cube\n\t\tthis.mesh.add(\n\t\t\t(new Cube(\n\t\t\t\t[400, 400, 400],\n\t\t\t\t{x: 0, y: 0, z: 0},\n\t\t\t\tcolors.lightBrown,\n\t\t\t\t'middle-cube-basement')\n\t\t\t).mesh\n\t\t);\n\n\n\t\t// fans\n\t\tthis.fans = [];\n\n\t\tconst fansParams = [\n\t\t\t{x: 200, y: 100, z: -100, rx: -Math.PI / 2, rz: -Math.PI / 2},\n\t\t\t{x: 200, y: -50, z: 100, rx: -Math.PI / 2, rz: -Math.PI / 2}\n\t\t];\n\n\t\tfor (let i = 0; i < fansParams.length; i++) {\n\t\t\tconst fan = new Fan();\n\t\t\tfan.mesh.position.set(\n\t\t\t\tfansParams[i].x,\n\t\t\t\tfansParams[i].y,\n\t\t\t\tfansParams[i].z\n\t\t\t);\n\t\t\tfan.mesh.rotation.set(\n\t\t\t\tfansParams[i].rx,\n\t\t\t\t0,\n\t\t\t\tfansParams[i].rz\n\t\t\t);\n\n\t\t\tthis.fans.push(fan);\n\t\t};\n\n\n\t\t// fence perimeter\n\t\tconst fenceParams = [\n\t\t\t{x: 190, z: -190, ry: 0, mx: -1, mz: 0, count: 11},\n\t\t\t{x: 190, z: 185, ry: -Math.PI / 2, mx: 0, mz: -1, count: 10},\n\t\t\t{x: -190, z: 190, ry: 0, mx: 1, mz: 0, count: 4},\n\t\t\t{x: 80, z: 185, ry: Math.PI, mx: 1, mz: 0, count: 3},\n\t\t];\n\t\tconst fenceWidth = 38;\n\t\tlet fenceGeometry = new Geometry();\n\n\t\tfor (let i = 0; i < fenceParams.length; i++) {\n\n\t\t\tfor(let j = 0; j < fenceParams[i].count; j++) {\n\n\t\t\t\tconst fence = (new Fence()).mesh;\n\t\t\t\tfence.position.set(\n\t\t\t\t\tfenceParams[i].x + (j * fenceParams[i].mx * fenceWidth),\n\t\t\t\t\t210,\n\t\t\t\t\tfenceParams[i].z + (j * fenceParams[i].mz * fenceWidth)\n\t\t\t\t);\n\t\t\t\tfence.rotation.y = fenceParams[i].ry;\n\t\t\t\tfence.updateMatrix();\n\n\t\t\t\tfenceGeometry.merge(fence.geometry, fence.matrix);\n\t\t\t};\n\n\t\t};\n\n\t\tconst fencePerimeter = new Mesh(fenceGeometry, materials.wood);\n\t\tfencePerimeter.name = 'fence-perimeter';\n\t\tfencePerimeter.castShadow = true;\n\t\tfencePerimeter.receiveShadow = true;\n\n\n\t\t// pine\n\t\tconst pine = new Pine([1.2, 2, 1.2]).mesh;\n\t\tpine.position.set(-140, 200, 140);\n\n\n\t\t// windvane\n\t\tconst windvane = new Windvane();\n\t\twindvane.mesh.position.set(100, 200, -50);\n\t\twindvane.mesh.rotation.y += Math.PI / 16;\n\n\t\tthis.windvane = windvane;\n\n\n\t\t// ladder\n\t\tconst ladder = new Ladder().mesh;\n\t\tladder.position.set(-158, 200, -90);\n\t\tladder.rotation.z = Math.PI / 32;\n\n\n\t\t// stones\n\t\tconst stonesCoordinates = [];\n\n\t\tfor (let i = 0; i < 12; i++) {\n\t\t\tstonesCoordinates.push(\n\t\t\t\t[\n\t\t\t\t\t250 * Math.cos(i * Math.PI / 24),\n\t\t\t\t\t0,\n\t\t\t\t\t-180 * Math.sin(i * Math.PI / 24),\n\t\t\t\t]\n\t\t\t);\n\t\t};\n\n\t\tfor (let i = 0; i < 8; i++) {\n\t\t\tstonesCoordinates.push(\n\t\t\t\t[\n\t\t\t\t\t150 * Math.cos(i * Math.PI / 16) + 10,\n\t\t\t\t\t0,\n\t\t\t\t\t-100 * Math.sin(i * Math.PI / 16),\n\t\t\t\t]\n\t\t\t);\n\t\t};\n\n\t\tconst stones = new Stones(stonesCoordinates).mesh;\n\t\tstones.position.set(-210, 200, 170);\n\n\n\t\t// back side pipes\n\t\tconst pipesGeometry = new Geometry();\n\t\tconst glassGeometry = new Geometry();\n\n\t\tconst pipesParams = [\n\t\t\t{\n\t\t\t\ttype: 'straight',\n\t\t\t\tposition: [80, -475, 125],\n\t\t\t\trotation: [(Math.PI / 2), 0, 0]\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'connection',\n\t\t\t\tposition: [80, -475, 35],\n\t\t\t\trotation: [(Math.PI / 2), 0, 0],\n\t\t\t\toptions: {\n\t\t\t\t\tm: 1\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'arc',\n\t\t\t\tposition: [80, -397.5, 20],\n\t\t\t\trotation: [-(Math.PI / 2), (Math.PI / 2), -(Math.PI / 2)],\n\t\t\t\toptions: {\n\t\t\t\t\tscale: 1.1\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'connection',\n\t\t\t\tposition: [80, -300, -57.5],\n\t\t\t\trotation: [0, 0, 0],\n\t\t\t\toptions: {\n\t\t\t\t\tm: 8\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'straight',\n\t\t\t\tposition: [-275, -75, 80],\n\t\t\t\trotation: [0, 0, (Math.PI / 2)]\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'connection',\n\t\t\t\tposition: [-360, -75, 80],\n\t\t\t\trotation: [0, 0, (Math.PI / 2)],\n\t\t\t\toptions: {\n\t\t\t\t\tm: 1\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'arc',\n\t\t\t\tposition: [-370, 0, 80],\n\t\t\t\trotation: [0, 0, (Math.PI / 2)],\n\t\t\t\toptions: {\n\t\t\t\t\tscale: 1.1\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'connection',\n\t\t\t\tposition: [-450, 150, 80],\n\t\t\t\trotation: [0, 0, 0],\n\t\t\t\toptions: {\n\t\t\t\t\tm: 4\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\tfor (let i = 0; i < pipesParams.length; i++) {\n\n\t\t\tlet pipe;\n\t\t\t\n\t\t\t// \n\t\t\tfunction setParams(el, params) {\n\t\t\t\tel.position.set(\n\t\t\t\t\tparams.position[0],\n\t\t\t\t\tparams.position[1],\n\t\t\t\t\tparams.position[2],\n\t\t\t\t);\n\t\t\t\tel.rotation.set(\n\t\t\t\t\tparams.rotation[0],\n\t\t\t\t\tparams.rotation[1],\n\t\t\t\t\tparams.rotation[2],\n\t\t\t\t);\n\t\t\t\tel.updateMatrix();\n\t\t\t};\n\n\t\t\tswitch (pipesParams[i].type) {\n\t\t\t\tcase 'straight':\n\t\t\t\t\tpipe = new Mesh(\n\t\t\t\t\t\tnew CylinderGeometry(35, 35, 150, 8, 1)\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'connection':\n\t\t\t\t\tpipe = (new PipeConnection(pipesParams[i].options.m)).mesh;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'arc':\n\t\t\t\t\tpipe = (new PipeCorner(false, false)).mesh;\n\t\t\t\t\tpipe.scale.set(\n\t\t\t\t\t\tpipesParams[i].options.scale,\n\t\t\t\t\t\tpipesParams[i].options.scale,\n\t\t\t\t\t\tpipesParams[i].options.scale\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t};\n\t\t\tsetParams(pipe, pipesParams[i]);\n\n\t\t\tpipesGeometry.merge(pipe.geometry, pipe.matrix);\n\n\t\t};\n\n\t\tconst pipes = new Mesh(pipesGeometry, materials.lightMetal);\n\t\tpipes.castShadow = true;\n\t\tpipes.receiveShadow = true;\n\n\n\t\t// final\n\t\tthis.mesh.add(\n\t\t\tfencePerimeter,\n\t\t\tpine,\n\t\t\twindvane.mesh,\n\t\t\tladder,\n\t\t\tstones,\n\t\t\t...(this.fans.map(fan => fan.mesh)),\n\t\t\tpipes\n\t\t);\n\t\t\n\t}\n}","import {\n\tShape,\n\tCatmullRomCurve3,\n\tVector3,\n\tMesh,\n\tCylinderGeometry,\n\tExtrudeGeometry } from 'three';\n\n\nexport default class Chimney {\n\tconstructor(width, height, radius = 5, steps = 8) {\n\n\t\tthis.radius = radius;\n\n\t\tconst spline = new CatmullRomCurve3([\n\t\t\tnew Vector3(0, 0, 0),\n\t\t\tnew Vector3(0, 0, width),\n\t\t\tnew Vector3(0, height, width + radius),\n\t\t]\n\t\t);\n\t\t\n\t\tconst pipeShape = new Shape();\n\t\t\n\t\tpipeShape.moveTo(\n\t\t\tthis.radius * Math.cos(0),\n\t\t\tthis.radius * Math.sin(0)\n\t\t);\n\n\t\tfor (let i = 1; i < 16; i++) {\n\t\t\tpipeShape.lineTo(\n\t\t\t\tthis.radius * Math.cos(i * (2 * Math.PI) / 16),\n\t\t\t\tthis.radius * Math.sin(i * (2 * Math.PI) / 16)\n\t\t\t);\n\t\t};\n\n\t\tthis.mesh = new Mesh(\n\t\t\tnew ExtrudeGeometry(\n\t\t\t\tpipeShape,\n\t\t\t\t{\n\t\t\t\t\tcurveSegments \t: 8,\n\t\t\t\t\tsteps\t\t\t: steps,\n\t\t\t\t\tbevelEnabled\t: false,\n\t\t\t\t\textrudePath\t\t: spline\n\t\t\t\t}\n\t\t\t),\n\t\t);\n\t}\n}","import {\n\tGeometry,\n\tMesh,\n\tObject3D,\n\tCylinderGeometry,\n\tExtrudeGeometry,\n\tShape,\n\tPath\n} from 'three';\n\nimport Cube from '../../modules/Cube';\nimport Chimney from './chimney';\n\nimport { colors } from '../../modules/colors';\n\nimport { materials } from '../../modules/materials';\n\n\nexport default class House {\n\tconstructor() {\n\n\t\tthis.mesh = new Object3D();\n\t\tthis.mesh.name = 'house';\n\n\t\t// stage\n\t\tconst size = {\n\t\t\tx: 140,\n\t\t\ty: 50,\n\t\t\tz: 140\n\t\t};\n\n\t\t// first floor\n\t\tconst firstFloor = new Cube(\n\t\t\t[size.x, size.y, size.z],\n\t\t\t{x: 0, y: (size.y / 2), z: -100},\n\t\t\tcolors.brick,\n\t\t\t'first-floor'\n\t\t).mesh;\n\t\tfirstFloor.castShadow = true;\n\t\tfirstFloor.receiveShadow = true;\n\n\t\t// basement\n\t\tconst basement = new Cube(\n\t\t\t[size.x + 10, size.y / 10, size.z + 10],\n\t\t\t{x: 0, y: (size.y / 20), z: -100},\n\t\t\tcolors.darkMetal,\n\t\t\t'basement'\n\t\t).mesh;\n\t\tbasement.castShadow = true;\n\t\tbasement.receiveShadow = true;\n\n\t\t// roof\n\t\tconst roof = new Object3D();\n\n\t\tconst roofLow = new Mesh(\n\t\t\tnew CylinderGeometry( (size.x - 40), (size.x - 35), 5, 4, 1 ),\n\t\t\tmaterials.brick\n\t\t);\n\t\troofLow.position.y -= 2.5;\n\t\troofLow.castShadow = true;\n\t\troofLow.receiveShadow = true;\n\n\t\tconst roofMiddle = new Mesh(\n\t\t\tnew CylinderGeometry( 20, 20, 5, 4, 1 ),\n\t\t\tmaterials.brick\n\t\t);\n\t\troofMiddle.position.y += 122.5;\n\t\troofMiddle.castShadow = true;\n\t\troofMiddle.receiveShadow = true;\n\n\t\tconst roofTop = new Mesh(\n\t\t\tnew CylinderGeometry( 15, 15, 5, 4, 1 ),\n\t\t\tmaterials.brick\n\t\t);\n\t\troofTop.position.y += 155;\n\t\troofTop.castShadow = true;\n\t\troofTop.receiveShadow = true;\n\n\n\n\t\troof.add(\n\t\t\troofLow,\n\t\t\troofMiddle,\n\t\t\troofTop\n\t\t);\n\t\troof.position.set(0, size.y, -100),\n\t\troof.rotation.y += Math.PI / 4;\n\n\t\t\n\t\t// roof parts\n\t\tconst roofCombinedGeometry = new Geometry();\n\n\t\tconst roofParams = [\n\t\t\t{ y: 20,  rT: 50, rB: 100, height: 40 },\n\t\t\t{ y: 70,  rT: 20, rB: 50,  height: 60 },\n\t\t\t{ y: 110, rT: 15, rB: 20,  height: 20 },\n\t\t\t{ y: 130, rT: 30, rB: 15,  height: 10 },\n\t\t\t{ y: 145, rT: 10, rB: 30,  height: 20 },\n\t\t\t{ y: 165, rT: 1,  rB: 10,  height: 20 },\n\t\t];\n\n\t\tfor (let i = 0; i < roofParams.length; i++) {\n\t\t\tconst roofPart = new Mesh(\n\t\t\t\tnew CylinderGeometry(\n\t\t\t\t\troofParams[i].rT,\n\t\t\t\t\troofParams[i].rB,\n\t\t\t\t\troofParams[i].height,\n\t\t\t\t\t4, 1\n\t\t\t\t),\n\t\t\t);\n\t\t\troofPart.position.y += roofParams[i].y;\n\t\t\troofPart.updateMatrix();\n\t\t\troofCombinedGeometry.merge(roofPart.geometry, roofPart.matrix);\n\t\t};\n\n\t\tconst roofCombined = new Mesh(roofCombinedGeometry, materials.roof);\n\t\troofCombined.castShadow = true;\n\t\troofCombined.receiveShadow = true;\n\n\t\troof.add(roofCombined);\n\n\t\t\n\t\t// chimneys\n\t\tconst chimneyCombinedGeometry = new Geometry();\n\n\t\tconst chimneyParams = [\n\t\t\t{ x: 0, y: 100, z: -70, width: 30, height: 50 },\n\t\t\t{ x: -10, y: 120, z: -80, width: 20, height: 80 }\n\t\t];\n\n\t\tfor (let i = 0; i < chimneyParams.length; i++) {\n\t\t\tconst chimney = (new Chimney(\n\t\t\t\tchimneyParams[i].width,\n\t\t\t\tchimneyParams[i].height\n\t\t\t)).mesh;\n\t\t\tchimney.position.set(\n\t\t\t\tchimneyParams[i].x,\n\t\t\t\tchimneyParams[i].y,\n\t\t\t\tchimneyParams[i].z\n\t\t\t);\n\t\t\tchimney.updateMatrix();\n\t\n\t\t\tchimneyCombinedGeometry.merge(chimney.geometry, chimney.matrix);\n\t\t};\n\n\t\tconst chimneyCombined = new Mesh(\n\t\t\tchimneyCombinedGeometry, materials.lightMetal\n\t\t);\n\t\tchimneyCombined.castShadow = true;\n\t\tchimneyCombined.receiveShadow = true;\n\n\n\t\t// door\n\t\tconst doorShape = new Shape();\n\n\t\tdoorShape.moveTo(15, -15);\n\t\tdoorShape.lineTo(15, 15);\n\n\t\tfor (let i = 0; i < 8; i++) {\n\t\t\tdoorShape.lineTo(\n\t\t\t\t15 * Math.cos( i * Math.PI / 8 ),\n\t\t\t\t10 * Math.sin( i * Math.PI / 8 ) + 15\n\t\t\t);\n\t\t};\n\n\t\tdoorShape.lineTo(-15, -15);\n\t\tdoorShape.moveTo(-15, 15);\n\n\t\tconst extrudeSettings = {\n\t\t\tsteps: 2,\n\t\t\tdepth: 4,\n\t\t\tbevelEnabled: false\n\t\t};\n\n\t\tconst door = new Mesh(\n\t\t\tnew ExtrudeGeometry(doorShape, extrudeSettings),\n\t\t\tmaterials.wood\n\t\t);\n\t\tdoor.castShadow = true;\n\t\tdoor.receiveShadow = true;\n\n\t\tdoor.position.set(70, 15, -125);\n\t\tdoor.rotation.y = Math.PI / 2;\n\n\n\t\t// window\n\t\tconst windowShape = new Shape();\n\t\twindowShape.moveTo(0, 0);\n\t\twindowShape.absarc(0, 0, 15, 0, Math.PI * 2);\n\n\t\tconst holePath = new Path();\n\t\tholePath.moveTo(0, 0);\n\t\tholePath.absarc(0, 0, 12, 0, Math.PI * 2);\n\t\twindowShape.holes.push( holePath );\n\n\t\tconst windowGeometry = new ExtrudeGeometry(\n\t\t\twindowShape,\n\t\t\t{\n\t\t\t\tdepth: 4,\n\t\t\t\tsteps: 1,\n\t\t\t\tbevelEnabled: false\n\t\t\t}\n\t\t);\n\n\t\tconst horizontalFrame = new Cube([1, 30, 4]);\n\t\tconst verticalFrame = new Cube([30, 1, 4]);\n\n\t\twindowGeometry.merge(horizontalFrame.geometry, horizontalFrame.matrix);\n\t\twindowGeometry.merge(verticalFrame.geometry, verticalFrame.matrix);\n\t\t\n\t\tconst houseWindow = new Mesh(windowGeometry, materials.wood);\n\t\thouseWindow.position.set(70, 25, -65);\n\t\thouseWindow.rotation.y = Math.PI / 2;\n\t\thouseWindow.scale.x = 1.15\n\n\t\thouseWindow.receiveShadow = true;\n\t\thouseWindow.castShadow = true;\n\n\n\n\t\t// final\n\t\tthis.mesh.add(\n\t\t\tbasement,\n\t\t\tfirstFloor,\n\t\t\tdoor,\n\t\t\thouseWindow,\n\t\t\troof,\n\t\t\tchimneyCombined\n\t\t);\n\t}\n}","import { Object3D, Mesh, Geometry, MeshPhongMaterial } from 'three';\n\nimport Cube from '../../modules/Cube';\nimport Fence from '../fence';\nimport Fan from '../fan';\nimport Pine from '../pine';\nimport PipeCorner from '../pipeCorner';\nimport House from './House';\n\nimport { colors } from '../../modules/colors';\nimport { materials } from '../../modules/materials';\n\n\nexport default class TopIsland {\n\tconstructor() {\n\n\t\tthis.mesh = new Object3D();\n\t\tthis.mesh.name = 'top-island';\n\n\t\t// big cube\n\t\tthis.mesh.add(\n\t\t\t(new Cube(\n\t\t\t\t[400, 400, 400],\n\t\t\t\t{ x: 0, y: 0, z: 0 },\n\t\t\t\tcolors.lightGreen)\n\t\t\t).mesh\n\t\t);\n\n\n\t\t// fans\n\t\tthis.fans = [];\n\n\t\tconst fansParams = [\n\t\t\t{ x: -100, y: 100 },\n\t\t\t{ x: 100, y: -100 }\n\t\t];\n\n\t\tfor (let i = 0; i < fansParams.length; i++) {\t\n\t\t\tconst fan = new Fan();\n\t\t\tfan.mesh.position.set(\n\t\t\t\tfansParams[i].x,\n\t\t\t\tfansParams[i].y,\n\t\t\t\t200\n\t\t\t);\n\t\t\tfan.mesh.rotation.set(\n\t\t\t\tMath.PI / 2,\n\t\t\t\tMath.PI,\n\t\t\t\t0\n\t\t\t);\n\t\t\tthis.fans.push(fan);\n\t\t};\n\n\t\tthis.fans.map(fan => {\n\t\t\tthis.mesh.add(fan.mesh)\n\t\t});\n\n\n\t\t// house\n\t\tconst house = (new House()).mesh;\n\t\thouse.position.x += 70;\n\t\thouse.position.y += 200;\n\t\thouse.position.z += 5;\n\t\thouse.rotation.y -= Math.PI / 16;\n\n\t\tthis.mesh.add(\n\t\t\thouse\n\t\t);\n\n\n\t\t// fence perimeter\n\t\tlet fenceGeometry = new Geometry();\n\n\t\tconst fenceParams = [\n\t\t\t{x: 190, z: 187, ry: 0, mx: -1, mz: 0, count: 10},\n\t\t\t{x: -187, z: 185, ry: -Math.PI / 2, mx: 0, mz: -1, count: 10},\n\t\t\t{x: -187, z: -187, ry: Math.PI, mx: 1, mz: 0, count: 10},\n\t\t\t{x: 190, z: 118, ry: Math.PI / 2, mx: 0, mz: 1, count: 2},\n\t\t\t{x: 187, z: -155, ry: -Math.PI / 2, mx: 0, mz: -1, count: 1},\n\t\t];\n\t\tconst fenceWidth = 38;\n\n\t\tfor (let i = 0; i < fenceParams.length; i++) {\n\n\t\t\tfor(let j = 0; j < fenceParams[i].count; j++) {\n\n\t\t\t\tconst fence = (new Fence()).mesh;\n\t\t\t\tfence.position.set(\n\t\t\t\t\tfenceParams[i].x + (j * fenceParams[i].mx * fenceWidth),\n\t\t\t\t\t210,\n\t\t\t\t\tfenceParams[i].z + (j * fenceParams[i].mz * fenceWidth)\n\t\t\t\t);\n\t\t\t\tfence.rotation.y = fenceParams[i].ry;\n\t\t\t\tfence.updateMatrix();\n\n\t\t\t\tfenceGeometry.merge(fence.geometry, fence.matrix);\n\t\t\t};\n\n\t\t};\n\n\t\tconst fencePerimeter = new Mesh(fenceGeometry, materials.wood);\n\t\tfencePerimeter.name = 'fence-perimeter';\n\t\tfencePerimeter.castShadow = true;\n\t\tfencePerimeter.receiveShadow = true;\n\n\t\tthis.mesh.add(\n\t\t\tfencePerimeter\n\t\t);\n\n\n\t\t// pines\n\t\tconst pineParams = [\n\t\t\t{ x: 120, y: 200, z: 140, sx: 1, sy: 1, sz: 1 },\n\t\t\t{ x: 15, y: 200, z: 140, sx: 1, sy: 1.2, sz: 1 },\n\t\t\t{ x: -100, y: 200, z: 140, sx: 1.1, sy: 1.5, sz: 1.1 },\n\t\t\t{ x: -90, y: 200, z: -80, sx: 1.6, sy: 1.8, sz: 1.6 },\n\t\t];\n\n\t\tfor (let i = 0; i < pineParams.length; i++) {\n\t\t\tconst pine = (new Pine([\n\t\t\t\tpineParams[i].sx,\n\t\t\t\tpineParams[i].sy,\n\t\t\t\tpineParams[i].sz\n\t\t\t])).mesh;\n\t\t\tpine.position.set(\n\t\t\t\tpineParams[i].x,\n\t\t\t\tpineParams[i].y,\n\t\t\t\tpineParams[i].z\n\t\t\t);\n\n\t\t\tthis.mesh.add(pine);\n\t\t};\n\n\n\t\t// pipe corner\n\t\tconst pipeCorner = (new PipeCorner()).mesh;\n\t\tpipeCorner.position.x -= 60;\n\t\tpipeCorner.position.y += 215;\n\t\tpipeCorner.position.z += 40;\n\n\t\tthis.mesh.add(pipeCorner);\n\n\t\tthis.mesh.position.set(-400, 400, 0);\n\t}\n}","import {\n\tVector2,\n\tMesh,\n\tGeometry,\n\tExtrudeGeometry,\n\tLatheGeometry,\n\tShape,\n\tObject3D,\n\tEdgesGeometry,\n\tLineBasicMaterial,\nLineSegments } from 'three';\n\nimport { materials } from '../../modules/materials';\n\n\nexport default class Balloon {\n\tconstructor() {\n\n\t\tthis.mesh = new Object3D();\n\t\tthis.mesh.name = 'zeppelin-balloon';\n\n\t\tconst radius = 200;\n\t\tconst pointsCount = 12;\n\n\n\t\t// points\n\t\tconst points = [];\n\t\tfor (let i = 0; i < pointsCount; i++) {\n\t\t\tpoints.push(\n\t\t\t\tnew Vector2(\n\t\t\t\t\tradius * Math.sin( i * (Math.PI / pointsCount) ),\n\t\t\t\t\tradius * Math.cos( i * (Math.PI / pointsCount) ) * 2\n\t\t\t\t)\n\t\t\t);\n\t\t};\n\n\n\t\n\t\t// balloon\n\t\tconst balloon = new Mesh(\n\t\t\tnew LatheGeometry( points ),\n\t\t\tmaterials.balloon\n\t\t);\n\t\t// balloon.castShadow = true;\n\t\tballoon.receiveShadow = true;\n\n\n\n\t\t// frame\n\t\tconst frameShape = new Shape();\n\t\tframeShape.moveTo( points[0].y, points[0].x );\n\n\t\tfor (let i = 1; i < (points.length - 1); i++) {\n\t\n\t\t\tframeShape.lineTo( points[i].y, points[i].x );\n\t\n\t\t};\n\t\tframeShape.moveTo( points[points.length] );\n\n\t\tconst frame = new Mesh(\n\t\t\tnew ExtrudeGeometry(\n\t\t\t\tframeShape,\n\t\t\t\t{\n\t\t\t\t\tsteps: 1,\n\t\t\t\t\tdepth: 20,\n\t\t\t\t\tbevelEnabled: false\n\t\t\t\t}\n\t\t\t),\n\t\t\tmaterials.lightMetal\n\t\t);\n\t\t// frame.rotation.y += Math.PI / 6;\n\t\tframe.rotation.z -= Math.PI / 2;\n\t\tframe.position.set(5, 0, -10);\n\n\t\tframe.castShadow = true;\n\t\tframe.receiveShadow = true;\n\n\n\t\t// final\n\t\tthis.mesh.add(\n\t\t\tballoon,\n\t\t\tframe\n\t\t);\n\n\t\tthis.mesh.rotation.x = Math.PI / 2;\n\n\t}\n}","import {\n\tShape,\n\tCatmullRomCurve3,\n\tMesh,\n\tExtrudeGeometry } from 'three';\n\n\nexport default class Hose {\n\tconstructor(radius, points, steps = 15) {\n\n\t\tthis.radius = radius;\n\t\t\n\t\tconst spline = new CatmullRomCurve3( points );\n\t\t\n\t\tconst shape = new Shape();\n\t\t\n\t\tshape.moveTo(\n\t\t\tthis.radius * Math.cos(0),\n\t\t\tthis.radius * Math.sin(0)\n\t\t);\n\n\t\tfor (let i = 1; i < 16; i++) {\n\t\t\tshape.lineTo(\n\t\t\t\tthis.radius * Math.cos(i * (2 * Math.PI) / 16),\n\t\t\t\tthis.radius * Math.sin(i * (2 * Math.PI) / 16)\n\t\t\t);\n\t\t};\n\n\t\tthis.mesh = new Mesh(\n\t\t\tnew ExtrudeGeometry(\n\t\t\t\tshape,\n\t\t\t\t{\n\t\t\t\t\tsteps\t\t\t: steps,\n\t\t\t\t\tbevelEnabled\t: false,\n\t\t\t\t\textrudePath\t\t: spline\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tthis.mesh.name = 'hose';\n\t}\n}","import {\n\tObject3D,\n\tMesh,\n\tGeometry,\n\tCylinderGeometry,\n\tLatheGeometry,\n\tVector2,\n\tVector3,\n\tShape,\n\tExtrudeGeometry,\n\tMatrix4 } from 'three';\n\nimport Hose from './hose';\nimport Cube from '../../modules/Cube';\nimport { materials } from '../../modules/materials';\n\n\nexport default class Fan {\n\tconstructor(full = true, mirrored = false) {\n\n\t\tthis.mesh = new Object3D();\n\t\tthis.mesh.name = 'zeppelin-fan';\n\n\n\t\t\n\t\t// engine\n\t\tconst engineRadius = 40;\n\t\tconst engineGeometry = new Geometry();\n\t\t\n\t\tconst engineMain = new Mesh(\n\t\t\tnew CylinderGeometry(engineRadius, engineRadius - 5, (engineRadius * 2), 16, 1)\n\t\t);\n\n\t\tconst engineTopPoints = [];\n\n\t\tfor (let i = 0; i < 16; i++) {\n\t\t\tengineTopPoints.push(\n\t\t\t\tnew Vector2(\n\t\t\t\t\tengineRadius * Math.cos( i * (Math.PI / 32) ),\n\t\t\t\t\tengineRadius * Math.sin( i * (Math.PI / 32) ) / 3\n\t\t\t\t)\n\t\t\t);\n\t\t};\n\n\t\tconst engineTop = new Mesh(\n\t\t\tnew LatheGeometry( engineTopPoints, 8 ),\n\t\t);\n\t\tengineTop.position.y += engineRadius;\n\t\tengineTop.updateMatrix();\n\n\n\t\tconst engineTier = new Mesh(\n\t\t\tnew CylinderGeometry(5, 5, 120, 6, 1)\n\t\t);\n\t\tengineTier.position.set( -60, 0, 0 )\n\t\tengineTier.rotation.z -= Math.PI / 2;\n\t\tengineTier.updateMatrix();\n\n\n\t\tif (full) {\n\t\t\t// engine air flow grid\n\t\t\tconst sideLeft = (new Cube( [15, 45, 1] )).mesh;\n\t\t\tsideLeft.position.set(35, 5, 15);\n\t\t\tsideLeft.updateMatrix();\n\n\t\t\tconst sideRight = sideLeft.clone();\n\t\t\tsideLeft.position.z -= 30;\n\t\t\tsideLeft.updateMatrix();\n\n\t\t\tengineGeometry.merge(sideLeft.geometry, sideLeft.matrix);\n\t\t\tengineGeometry.merge(sideRight.geometry, sideRight.matrix);\n\n\t\t\tfor (let i = -2; i < 4; i++) {\n\t\t\t\tlet engineSegment = new Mesh(\n\t\t\t\t\tnew CylinderGeometry(4, 4, 30, 3, 1)\n\t\t\t\t);\n\t\t\t\tengineSegment.rotation.set(Math.PI / 2, Math.PI / 3, 0);\n\t\t\t\tengineSegment.position.set(\n\t\t\t\t\t(engineRadius + i / 2 - 2),\n\t\t\t\t\t(i * 8),\n\t\t\t\t\t0\n\t\t\t\t);\n\t\t\t\tengineSegment.updateMatrix();\n\t\n\t\t\t\tengineGeometry.merge(engineSegment.geometry, engineSegment.matrix);\n\t\t\t};\n\n\t\t\t// hose\n\t\t\tlet m = (mirrored) ? (-1) : 1;\n\t\t\t\n\t\t\tconst hose = new Hose(4, [\n\t\t\t\tnew Vector3(-10, 28, m * 35),\n\t\t\t\tnew Vector3(0, 5, m * 50),\n\t\t\t\tnew Vector3(10, -4, m * 55),\n\t\t\t\tnew Vector3(20, -8, m * 50),\n\t\t\t\tnew Vector3(24, -12, m * 40),\n\t\t\t\tnew Vector3(20, -16, m * 25),\n\t\t\t]).mesh;\n\n\t\t\tengineGeometry.merge(hose.geometry, hose.matrix);\n\t\t};\n\n\t\tconst engineHub = new Mesh(\n\t\t\tnew CylinderGeometry(5, 10, 15, 6, 1, true)\n\t\t);\n\t\tengineHub.position.y += 58;\n\t\tengineHub.updateMatrix();\n\n\n\t\tengineGeometry.merge(engineMain.geometry, engineMain.matrix);\n\t\tengineGeometry.merge(engineTop.geometry, engineTop.matrix);\n\t\tengineGeometry.merge(engineTier.geometry, engineTier.matrix);\n\t\tengineGeometry.merge(engineHub.geometry, engineHub.matrix);\n\n\t\tconst engine = new Mesh(engineGeometry, materials.lightMetal);\n\t\tengine.castShadow = true;\n\t\tengine.receiveShadow = true;\n\n\n\n\t\t// propeller\n\t\tconst propellerGeometry = new Geometry();\n\n\t\tconst pipe = new Mesh(\n\t\t\tnew CylinderGeometry(4, 4, 280, 6, 1)\n\t\t);\n\t\tpipe.position.set(0, 100, 0);\n\t\tpipe.updateMatrix();\n\n\n\t\tconst bladesHub = new Mesh(\n\t\t\tnew CylinderGeometry(12, 5, 10, 6, 1)\n\t\t);\n\t\tbladesHub.position.set(0, 228, 0);\n\t\tbladesHub.updateMatrix();\n\n\n\t\tconst bladesGeometry = new Geometry();\n\n\t\tconst bladeShape = new Shape();\n\n\t\tbladeShape.moveTo(0, -5);\n\t\tfor (let i = -4; i < 4; i++) {\n\t\t\tbladeShape.lineTo(\n\t\t\t\t120 + 10 * Math.cos(i * Math.PI / 8),\n\t\t\t\t10 * Math.sin(i * Math.PI / 8)\n\t\t\t);\n\t\t};\n\t\tbladeShape.lineTo(0, 5);\n\n\t\n\t\tfor (let i = 0; i < 4; i++) {\n\t\t\tlet blade = new Mesh(\n\t\t\t\tnew ExtrudeGeometry(\n\t\t\t\t\tbladeShape,\n\t\t\t\t\t{\n\t\t\t\t\t\tcurveSegments: 8,\n\t\t\t\t\t\tsteps: 1,\n\t\t\t\t\t\tdepth: 2,\n\t\t\t\t\t\tbevelEnabled: false\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t\tblade.rotation.z += i * (Math.PI / 2);\n\t\t\tblade.updateMatrix();\n\n\t\t\tbladesGeometry.merge(blade.geometry, blade.matrix);\n\t\t}\n\n\t\tconst blades = new Mesh(bladesGeometry, materials.white);\n\t\tblades.position.set(0, 235, 0);\n\t\tblades.geometry.applyMatrix4( new Matrix4().makeRotationX( Math.PI / 2 ) );\n\t\tblades.updateMatrix();\n\n\n\n\t\tpropellerGeometry.merge(pipe.geometry, pipe.matrix);\n\t\tpropellerGeometry.merge(bladesHub.geometry, bladesHub.matrix);\n\t\tpropellerGeometry.merge(blades.geometry, blades.matrix);\n\n\t\tthis.propeller = new Mesh(propellerGeometry, materials.white);\n\t\tthis.propeller.castShadow = true;\n\t\tthis.propeller.receiveShadow = true;\n\n\t\t// final\n\t\tthis.mesh.add(\n\t\t\tengine,\n\t\t\tthis.propeller\n\t\t);\n\t}\n\n\trotate = (value) => {\n\t\tthis.propeller.rotation.y += value\n\t}\n}","import {\n\tMesh,\n\tGeometry,\n\tCylinderGeometry,\n\tLatheGeometry,\n\tVector2 } from 'three';\n\nimport Cube from '../../modules/Cube';\nimport { materials } from '../../modules/materials';\n\n\nexport default class Tanks {\n\tconstructor() {\n\n\t\tconst tanksGeometry = new Geometry();\n\n\n\t\t// single tank\n\t\tconst tankGeometry = new Geometry();\n\t\tconst tankRadius = 30;\n\n\n\t\tconst tankCenter = new Mesh(\n\t\t\tnew CylinderGeometry(tankRadius, tankRadius, 70, 16, 1)\n\t\t);\n\n\t\tconst tankTopPoints = [];\n\n\t\tfor (let i = 0; i < 16; i++) {\n\t\t\ttankTopPoints.push(\n\t\t\t\tnew Vector2(\n\t\t\t\t\ttankRadius * Math.cos( i * (Math.PI / 32) ),\n\t\t\t\t\ttankRadius * Math.sin( i * (Math.PI / 32) ) / 2\n\t\t\t\t)\n\t\t\t);\n\t\t};\n\n\t\tconst tankTop = new Mesh(\n\t\t\tnew LatheGeometry( tankTopPoints, 12 ),\n\t\t);\n\t\ttankTop.position.y = 35;\n\t\ttankTop.updateMatrix();\n\n\t\tconst tankBottom = tankTop.clone();\n\t\ttankBottom.rotation.z += Math.PI;\n\t\ttankBottom.position.y = -35;\n\t\ttankBottom.updateMatrix();\n\n\t\tconst tankHub = new Mesh(new CylinderGeometry(8, 8, 10, 8, 1));\n\t\ttankHub.position.y += 50;\n\t\ttankHub.updateMatrix();\n\n\t\ttankGeometry.merge(tankCenter.geometry, tankCenter.matrix);\n\t\ttankGeometry.merge(tankTop.geometry, tankTop.matrix);\n\t\ttankGeometry.merge(tankBottom.geometry, tankBottom.matrix);\n\t\ttankGeometry.merge(tankHub.geometry, tankHub.matrix);\n\n\n\t\t// tank merge\n\t\tconst tankLeft = new Mesh(tankGeometry);\n\t\ttankLeft.position.z += 35;\n\t\ttankLeft.updateMatrix();\n\n\t\tconst tankRight = tankLeft.clone();\n\t\ttankRight.position.z -= 70;\n\t\ttankRight.updateMatrix();\n\n\n\t\t// frame\n\t\tconst frame = (new Cube( [5, 4, 80] )).mesh;\n\t\tframe.position.y += 52;\n\t\tframe.updateMatrix();\n\n\n\t\t// tier\n\t\tconst tier = new Mesh(\n\t\t\tnew CylinderGeometry(2, 2, 120, 6, 1)\n\t\t);\n\t\ttier.position.set( -60, 52, 0 )\n\t\ttier.rotation.z -= Math.PI / 2;\n\t\ttier.updateMatrix();\n\n\n\t\ttanksGeometry.merge(tankLeft.geometry, tankLeft.matrix);\n\t\ttanksGeometry.merge(tankRight.geometry, tankRight.matrix);\n\t\ttanksGeometry.merge(frame.geometry, frame.matrix);\n\t\ttanksGeometry.merge(tier.geometry, tier.matrix);\n\t\t\n\t\tthis.mesh = new Mesh(tanksGeometry, materials.lightMetal);\n\t\tthis.mesh.name = 'fuel-tanks';\n\t\tthis.mesh.castShadow = true;\n\t\tthis.mesh.receiveShadow = true;\n\t}\n}","import {\n\tGeometry,\n\tExtrudeGeometry,\n\tCylinderGeometry,\n\tMesh,\n\tObject3D,\n\tShape,\n\tPath } from 'three';\n\nimport Cube from '../../modules/Cube';\nimport { materials } from '../../modules/materials';\n\n\nexport default class Turbine {\n\tconstructor() {\n\n\t\tthis.mesh = new Object3D();\n\t\tthis.mesh.name = 'turbine';\n\n\t\tconst turbineGeometry = new Geometry();\n\n\t\n\t\tconst turbineOuterShape = new Shape();\n\t\tturbineOuterShape.moveTo(0, 0);\n\t\tturbineOuterShape.absarc(0, 0, 60, 0, Math.PI * 2);\n\n\t\tconst holePath = new Path();\n\t\tholePath.moveTo(0, 0);\n\t\tholePath.absarc(0, 0, 55, 0, Math.PI * 2);\n\t\tturbineOuterShape.holes.push( holePath );\n\n\t\tconst turbineOuter = new Mesh(\n\t\t\tnew ExtrudeGeometry(\n\t\t\t\tturbineOuterShape,\n\t\t\t\t{\n\t\t\t\t\tdepth: 80,\n\t\t\t\t\tsteps: 1,\n\t\t\t\t\tbevelEnabled: false\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tturbineOuter.position.z -= 40\n\t\tturbineOuter.updateMatrix();\n\n\n\t\t// pipe\n\t\tconst pipe = (new Cube(\n\t\t\t[150, 5, 30],\n\t\t\t{x: -130, y: 0, z: 0}\n\t\t)).mesh;\n\n\n\t\t// engine support\n\t\tconst engineSupport = (new Cube(\n\t\t\t[118, 5, 10]\n\t\t)).mesh;\n\t\tengineSupport.rotation.z += Math.PI / 4;\n\t\tengineSupport.updateMatrix();\n\n\n\t\tconst engine = new Mesh(\n\t\t\tnew CylinderGeometry(20, 20, 50, 8, 1)\n\t\t);\n\t\tengine.rotation.x += Math.PI / 2;\n\t\tengine.updateMatrix();\n\n\n\n\t\tturbineGeometry.merge(turbineOuter.geometry, turbineOuter.matrix);\n\t\tturbineGeometry.merge(pipe.geometry, pipe.matrix);\n\t\tturbineGeometry.merge(engineSupport.geometry, engineSupport.matrix);\n\t\tturbineGeometry.merge(engine.geometry, engine.matrix);\n\n\t\tconst turbine = new Mesh(turbineGeometry, materials.darkMetal);\n\t\tturbine.castShadow = true;\n\t\tturbine.receiveShadow = true;\n\n\n\t\t// propeller\n\t\tconst propellerGeometry = new Geometry();\n\n\t\tfor (let i = 0; i < 12; i++) {\n\t\t\tconst blade = new Cube(\n\t\t\t\t[50, 2, 1],\n\t\t\t\t{\n\t\t\t\t\tx: 4 * Math.cos(i * (Math.PI / 6)),\n\t\t\t\t\ty: 4 * Math.sin(i * (Math.PI / 6)),\n\t\t\t\t\tz: 30\n\t\t\t\t}\n\t\t\t).mesh;\n\t\t\tblade.geometry.translate(20, 0, 0);\n\n\t\t\tblade.geometry.vertices[1].z -= 8;\n\t\t\tblade.geometry.vertices[1].y += 10;\n\n\t\t\tblade.rotation.z += i * Math.PI / 6;\n\t\t\tblade.updateMatrix();\n\n\t\t\tpropellerGeometry.merge(blade.geometry, blade.matrix);\n\t\t};\n\n\t\t// hub\n\t\tconst propellerHub = new Mesh(\n\t\t\tnew CylinderGeometry(10, 1, 10, 8, 1)\n\t\t);\n\t\tpropellerHub.rotation.x -= Math.PI / 2;\n\t\tpropellerHub.position.z += 35;\n\t\tpropellerHub.updateMatrix();\n\t\tpropellerGeometry.merge(propellerHub.geometry, propellerHub.matrix);\n\n\n\t\t// full propeller\n\t\tthis.propeller = new Mesh(propellerGeometry, materials.lightMetal);\n\t\tthis.propeller.castShadow = true;\n\t\tthis.propeller.receiveShadow = true;\n\n\n\t\tthis.mesh.add(\n\t\t\tturbine,\n\t\t\tthis.propeller\n\t\t);\n\t}\n\n\trotate = (value) => {\n\t\tthis.propeller.rotation.z += value;\n\t}\n}","import {\n\tMesh,\n\tCylinderGeometry,\n\tObject3D } from 'three';\n\nimport { materials } from '../../modules/materials';\n\nimport Turbine from './Turbine';\n\n\nexport default class Cabine {\n\tconstructor() {\n\t\t\n\t\tthis.mesh = new Object3D();\n\t\tthis.mesh.name = 'cabine';\n\n\n\t\t// this\n\t\tconst cabine = new Mesh(\n\t\t\tnew CylinderGeometry(150, 100, 80, 16, 1),\n\t\t\tmaterials.darkMetal\n\t\t);\n\t\tcabine.scale.x = .5;\n\t\tcabine.updateMatrix();\n\n\n\t\t// turbine\n\t\tthis.turbines = [];\n\n\t\tconst turbineParams = [\n\t\t\t{x: 200, y: -50, z: 0, rx: 0, ry: 0, rz: 0},\n\t\t\t{x: -200, y: -50, z: 0, rx: Math.PI, ry: Math.PI, rz: Math.PI / 4},\n\t\t];\n\n\t\tfor (let i = 0; i < turbineParams.length; i++) {\n\t\t\tconst turbine = new Turbine();\n\t\t\tturbine.mesh.position.set(\n\t\t\t\tturbineParams[i].x,\n\t\t\t\tturbineParams[i].y,\n\t\t\t\tturbineParams[i].z\n\t\t\t);\n\n\t\t\tturbine.mesh.rotation.set(\n\t\t\t\tturbineParams[i].rx,\n\t\t\t\tturbineParams[i].ry,\n\t\t\t\tturbineParams[i].rz\n\t\t\t);\n\n\t\t\tturbine.mesh.rotation.z -= Math.PI / 8;\n\n\t\t\tthis.turbines.push(turbine);\n\t\t};\n\n\n\n\t\t// final\n\t\tthis.mesh.add(\n\t\t\tcabine,\n\t\t\t...(this.turbines.map(turbine => turbine.mesh))\n\t\t);\n\t\tthis.mesh.castShadow = true;\n\t\tthis.mesh.receiveShadow = true;\n\t}\n}","import { Object3D, ExtrudeGeometry, Geometry, Mesh, Vector3 } from 'three';\n\nimport { materials } from '../../modules/materials';\n\nimport Balloon from './Balloon';\nimport Fan from './Fan';\nimport Tanks from './Tanks';\nimport Cabine from './Cabine';\nimport Hose from './hose';\n\n\nexport default class Zeppelin {\n\tconstructor() {\n\n\t\tthis.mesh = new Object3D();\n\t\tthis.mesh.name = 'zeppelin';\n\n\t\tthis.mesh.position.set(-400, 550, -900);\n\n\n\t\tconst balloon = (new Balloon()).mesh;\n\t\t\n\t\t\n\t\t// fans\n\t\tthis.fans = [];\n\n\t\tconst fansParams = [\n\t\t\t{x: 250, y: 0, z: 200, ry: 0, full: true, mirrored: false},\n\t\t\t{x: 240, y: 0, z: -200, ry: 0, full: true, mirrored: true},\n\t\t\t{x: -250, y: 0, z: 200, ry: Math.PI, full: false, mirrored: false},\n\t\t\t{x: -240, y: 0, z: -200, ry: Math.PI, full: false, mirrored: false}\n\t\t];\n\n\t\tfor (let i = 0; i < fansParams.length; i++) {\n\t\t\tconst fan = new Fan(fansParams[i].full, fansParams[i].mirrored);\n\t\t\tfan.mesh.position.set(\n\t\t\t\tfansParams[i].x,\n\t\t\t\tfansParams[i].y,\n\t\t\t\tfansParams[i].z\n\t\t\t);\n\t\t\tfan.mesh.rotation.y += fansParams[i].ry;\n\t\t\t// fan.mesh.rotation.x += Math.PI;\n\t\t\tthis.fans.push(fan);\n\t\t};\n\n\n\t\t// fuel tanks\n\t\tconst tanks = (new Tanks()).mesh;\n\t\ttanks.rotation.z -= Math.PI / 8;\n\t\ttanks.position.set(220, -65, -50);\n\n\n\t\t// hoses\n\t\tconst hosesGeometry = new Geometry();\n\n\t\tconst hosesParams = [\n\t\t\t[\n\t\t\t\tnew Vector3(200, -110, -15),\n\t\t\t\tnew Vector3(210, -150, 20),\n\t\t\t\tnew Vector3(195, -10, 60),\n\t\t\t\tnew Vector3(195, -50, 100),\n\t\t\t\tnew Vector3(220, 0, 160)\n\t\t\t],\n\t\t\t[\n\t\t\t\tnew Vector3(200, -110, -85),\n\t\t\t\tnew Vector3(210, -160, -140),\n\t\t\t\tnew Vector3(220, 20, -180)\n\t\t\t]\n\t\t];\n\n\t\tfor (let i = 0; i < hosesParams.length; i++) {\n\t\t\tconst hose = (new Hose( 4, hosesParams[i], 40 )).mesh;\n\n\t\t\thosesGeometry.merge(hose.geometry, hose.matrix);\n\t\t};\n\n\t\tconst hoses = new Mesh(hosesGeometry, materials.lightMetal);\n\t\thoses.castShadow = true;\n\t\thoses.receiveShadow = true;\n\n\n\t\t// cabine\n\t\tthis.cabine = new Cabine();\n\t\tthis.cabine.mesh.position.y -= 210;\n\n\n\t\tthis.mesh.add(\n\t\t\tthis.cabine.mesh,\n\t\t\tballoon,\n\t\t\t...(this.fans.map(fan => fan.mesh)),\n\t\t\ttanks,\n\t\t\thoses\n\t\t);\n\n\t\t// this.mesh.rotation.z = Math.PI;\n\t}\n}","import { Shape, Mesh, Vector3, ExtrudeGeometry, CatmullRomCurve3 } from 'three';\n\nimport { materials } from './materials';\n\n\nexport default class Water {\n\tconstructor(points = [new Vector3(0, 0, 0), new Vector3(1, 1, 1)], steps = 10) {\n\n\t\t// river path\n\t\tconst spline = new CatmullRomCurve3(points);\n\n\t\tvar extrudeSettings = {\n\t\t\tsteps\t\t\t: steps,\n\t\t\tbevelEnabled\t: false,\n\t\t\textrudePath\t\t: spline\n\t\t};\n\n\t\tconst circle = new Shape();\n\t\tconst cirlceRadius = 36;\n\t\tconst circleSegments = 16;\n\n\t\tcircle.moveTo(cirlceRadius * Math.cos(0), cirlceRadius * Math.sin(0));\n\n\t\tfor (let i = 1; i < circleSegments; i++) {\n\t\t\tcircle.lineTo(\n\t\t\t\tcirlceRadius * Math.cos(i * (2 * Math.PI) / circleSegments),\n\t\t\t\tcirlceRadius * Math.sin(i * (2 * Math.PI) / circleSegments) / 1.5\n\t\t\t);\n\t\t};\n\n        const geometry = new ExtrudeGeometry(circle, extrudeSettings);\n        const material = materials.water;\n\n\n\t\t// animation prepare\n        geometry.mergeVertices();\n\n\t\tconst l = geometry.vertices.length;\n\t\n        this.waves = [];\n\n        for (let i = 0; i < l; i++) {\n\n\t\t\tconst v = geometry.vertices[i];\n\n\t\t\tthis.waves.push({\n\t\t\t\ty: v.y,\n\t\t\t\tx: v.x,\n\t\t\t\tz: v.z,\n\t\t\t\tang: Math.random() * Math.PI * 2,\n\t\t\t\tamp: 5 + Math.random() * 15,\n\t\t\t\tspeed: 0.032 + Math.random() * 0.064\n\t\t\t});\n\t\t};\n\t\t\n\t\tthis.mesh = new Mesh(geometry, material);\n\t\tthis.mesh.receiveShadow = true;\n\t\tthis.mesh.castShadow = true;\n\t}\n\n\tmoveWaves = () => {\n\n\t\tconst verts = this.mesh.geometry.vertices;\n\t\tconst l = verts.length;\n\n\t\tfor (let i = 0; i < l; i++) {\n\t\t\t\n\t\t\tconst v = verts[i];\n\n\t\t\t// get the data associated to it\n\t\t\tconst vprops = this.waves[i];\n\n\t\t\t// update the position of the vertex\n\t\t\tv.x = vprops.x - Math.cos(vprops.ang) * vprops.amp;\n\t\t\tv.y = vprops.y + Math.sin(vprops.ang) * vprops.amp;\n\n\t\t\t// increment the angle for the next frame\n\t\t\tvprops.ang += vprops.speed;\n\n\t\t}\n\n\t\tthis.mesh.geometry.verticesNeedUpdate = true;\n\t}\n}","import {\n\tObject3D,\n\tGeometry,\n\tCylinderGeometry,\n\tMesh,\n\tPointLight } from 'three';\n\nimport Cube from './Cube';\n\nimport { materials } from './materials';\n\n\nexport default class LampPost {\n\tconstructor() {\n\n\t\tthis.mesh = new Object3D();\n\t\tthis.mesh.name = 'lamp-post';\n\n\t\t// base\n\t\tconst baseVertical = (new Cube(\n\t\t\t[8, 100, 8]\n\t\t)).mesh;\n\t\tbaseVertical.geometry.vertices[2].x += 1;\n\t\tbaseVertical.geometry.vertices[2].z += 1;\n\t\tbaseVertical.geometry.vertices[3].x += 1;\n\t\tbaseVertical.geometry.vertices[3].z -= 1;\n\t\tbaseVertical.geometry.vertices[6].x -= 1;\n\t\tbaseVertical.geometry.vertices[6].z -= 1;\n\t\tbaseVertical.geometry.vertices[7].x -= 1;\n\t\tbaseVertical.geometry.vertices[7].z += 1;\n\t\tbaseVertical.updateMatrix();\n\n\t\tconst baseHorizontal = (new Cube(\n\t\t\t[6, 6, 40],\n\t\t\t{x: 0, y: 45, z: 12}\n\t\t)).mesh;\n\n\t\tconst baseAngle = (new Cube(\n\t\t\t[4, 4, 20],\n\t\t\t{x: 0, y: 38, z: 10}\n\t\t)).mesh;\n\t\tbaseAngle.rotation.x -= Math.PI / 4;\n\t\tbaseAngle.updateMatrix();\n\n\n\t\tconst baseGeometry = new Geometry();\n\t\tbaseGeometry.merge(baseVertical.geometry, baseVertical.matrix);\n\t\tbaseGeometry.merge(baseHorizontal.geometry, baseHorizontal.matrix);\n\t\tbaseGeometry.merge(baseAngle.geometry, baseAngle.matrix);\n\n\t\tconst base = new Mesh(baseGeometry, materials.wood);\n\t\tbase.castShadow = true;\n\t\tbase.receiveShadow = true;\n\n\n\t\t// lamp\n\t\tconst lamp = new Mesh(\n\t\t\tnew CylinderGeometry(1, 6, 4, 8),\n\t\t\tmaterials.darkMetal\n\t\t);\n\t\tlamp.castShadow = true;\n\t\tlamp.receiveShadow = true;\n\t\tlamp.position.set(0, 40, 30);\n\n\n\t\t// light\n\t\tthis.light = new PointLight(0xfddb92, 0, 0, 0);\n\n\t\tthis.light.castShadow = false;\n\t\tthis.light.shadow.mapSize.width = 16;\n\t\tthis.light.shadow.mapSize.height = 16;\n\n\t\tthis.light.position.set(-10, 30, 30);\n\n\n\t\tthis.mesh.add(\n\t\t\tbase,\n\t\t\tlamp,\n\t\t\tthis.light\n\t\t);\n\t}\n\n\tturnLights = (status) => {\n\t\tif (status) {\n\t\t\tthis.light.intensity = .95;\n\t\t\tthis.light.distance = 1000;\n\t\t\tthis.light.decay = 2;\n\t\t\tthis.light.castShadow = true;\n\t\t\tthis.light.shadow.mapSize.width = 128;\n\t\t\tthis.light.shadow.mapSize.height = 128;\n\t\t} else {\n\t\t\tthis.light.intensity = 0;\n\t\t\tthis.light.distance = 1;\n\t\t\tthis.light.decay = 1;\n\t\t\tthis.light.castShadow = false;\n\t\t\tthis.light.shadow.mapSize.width = 8;\n\t\t\tthis.light.shadow.mapSize.height = 8;\n\t\t};\n\t}\n}","\nexport const lightParams = {\n\n\tsunrise: {\n\t\themisphereLight: {\n\t\t\tintensity: .6\n\t\t},\n\t\tambientLight: {\n\t\t\tintensity: .3\n\t\t},\n\t\tsunLight: {\n\t\t\tintensity: .75,\n\t\t\tposition: [630, 210, -110],\n\t\t\tcolor: 0xffba87\n\t\t}\n\t},\n\n\tmidday: {\n\t\themisphereLight: {\n\t\t\tintensity: .9\n\t\t},\n\t\tambientLight: {\n\t\t\tintensity: .5\n\t\t},\n\t\tsunLight: {\n\t\t\tintensity: .75,\n\t\t\tposition: [-280, 695, 350],\n\t\t\tcolor: 0xffffff\n\t\t}\n\t},\n\n\tsunset: {\n\t\themisphereLight: {\n\t\t\tintensity: .6\n\t\t},\n\t\tambientLight: {\n\t\t\tintensity: .3\n\t\t},\n\t\tsunLight: {\n\t\t\tintensity: .75,\n\t\t\tposition: [-290, 560, 900],\n\t\t\tcolor: 0xffba87\n\t\t}\n\t},\n\n\tmidnight: {\n\t\themisphereLight: {\n\t\t\tintensity: .025\n\t\t},\n\t\tambientLight: {\n\t\t\tintensity: .025\n\t\t},\n\t\tsunLight: {\n\t\t\tintensity: .025,\n\t\t\tposition: [-420, 800, 370],\n\t\t\tcolor: 0xeeeeee\n\t\t}\n\t}\n\n}","\nexport const breakpoints = [6, 8, 17, 20];","\nexport default class Time {\n\tconstructor() {\n\t\tthis.now = new Date(0)\n\n\t\tthis.timeNode = document.getElementById('time')\n\t\tthis.dayNode = document.getElementById('day')\n\n\t\tthis.update()\n\t}\n\n\tupdate = () => {\n\t\tif ((Date.now() - this.now) > 60000) {\n\t\t\t\n\t\t\tthis.now = new Date()\n\n\t\t\tthis.hours = ('0' + this.now.getHours()).slice(-2)\n\t\t}\n\t}\n\n\tgetHours = () => this.hours\n}","import * as dat from 'dat.gui'\nimport {\n\tHemisphereLight,\n\tAmbientLight,\n\tObject3D,\n\tVector3,\n\tClock,\n\tDirectionalLightHelper,\n} from 'three'\n\nimport clamp from '@/utils/clamp'\n\nimport createScene from './createScene'\nimport createCamera from './createCamera'\nimport createRenderer from './createRenderer'\nimport createSun from './createSun'\n\nimport BottomIsland from '@/scene/BottomIsland/BottomIsland'\nimport MiddleIsland from '@/scene/MiddleIsland/MiddleIsland'\nimport TopIsland from '@/scene/TopIsland/TopIsland'\nimport Zeppelin from '@/scene/Zeppelin/Zeppelin'\n\nimport Water from './Water'\nimport LampPost from './LampPost'\n\n// temp\nimport { materials } from './materials'\n\nimport { lightParams } from './lightParams'\nimport { breakpoints } from './daytimeParams'\n\nimport Time from './Time'\n\n\nlet init = () => {\n\n\tlet WIDTH = window.innerWidth\n\tlet HEIGHT = window.innerHeight\n\n\twindow.addEventListener('resize', () => {\n\t\tWIDTH = window.innerWidth\n\t\tHEIGHT = window.innerHeight\n\n\t\trenderer.setSize(WIDTH, HEIGHT)\n\t\tcamera.aspect = WIDTH / HEIGHT\n\t\tcamera.updateProjectionMatrix()\n\t}, false)\n\n\n\tconst container = document.getElementById('scene')\n\tconst canvas = container.querySelector('canvas')\n\n\t// main\n\tconst scene = createScene()\n\tconst camera = createCamera(WIDTH, HEIGHT)\n\tconst renderer = createRenderer(canvas, WIDTH, HEIGHT, true)\n\n\n\t// lights (default params)\n\tconst hemisphereLight = new HemisphereLight(0xaaaaaa, 0x000000, .9)\n\tconst ambientLight = new AmbientLight(0x404040, .5)\n\tconst sunLight = createSun()\n\n\n\tlet setLights = dayTime => {\n\n\t\themisphereLight.intensity = lightParams[dayTime].hemisphereLight.intensity\n\n\t\tambientLight.intensity = lightParams[dayTime].ambientLight.intensity\n\n\t\tsunLight.intensity = lightParams[dayTime].sunLight.intensity\n\t\tsunLight.color.setHex(lightParams[dayTime].sunLight.color)\n\t\tsunLight.position.set(...lightParams[dayTime].sunLight.position)\n\n\t\t\n\t\tif (dayTime === 'midnight') {\n\t\t\tlampPosts.map(lampPost => lampPost.turnLights(true) )\n\t\t\tmaterials.line.color.setHex( 0x111111 );\n\t\t} else {\n\t\t\tlampPosts.map(lampPost => lampPost.turnLights() )\n\t\t\tmaterials.line.color.setHex( 0xdcbbb4 )\n\t\t}\n\t}\n\n\t// orbit controls\n\t// const controls = new OrbitControls(camera);\n\t// controls.enabled = false;\n\n\tconst bottomIsland = new BottomIsland()\n\tconst middleIsland = new MiddleIsland()\n\tconst topIsland = new TopIsland()\n\tconst zeppelin = new Zeppelin()\n\n\tconst islands = new Object3D()\n\tislands.name = 'islands'\n\n\tislands.add(\n\t\tbottomIsland.mesh,\n\t\tmiddleIsland.mesh,\n\t\ttopIsland.mesh,\n\t)\n\n\n\t// river parts\n\tconst river = []\n\n\tconst riverParams = [\n\t\t{\n\t\t\tpoints: [\n\t\t\t\tnew Vector3(-450, 690, 40),\n\t\t\t\tnew Vector3(-370, 615, 40),\n\t\t\t\tnew Vector3(-195, 600, 40),\n\t\t\t\tnew Vector3(-180, 210, 40),\n\t\t\t\tnew Vector3(-60, 210, 50),\n\t\t\t\tnew Vector3(-20, 210, 100),\n\t\t\t\tnew Vector3(15, 205, 210),\n\t\t\t\tnew Vector3(0, -180, 230),\n\t\t\t\tnew Vector3(0, -180, 570),\n\t\t\t],\n\t\t\tsteps: 25,\n\t\t},\n\t\t{\n\t\t\tpoints: [\n\t\t\t\tnew Vector3(0, -250, 665),\n\t\t\t\tnew Vector3(0, -380, 665),\n\t\t\t],\n\t\t\tsteps: 4,\n\t\t},\n\t\t{\n\t\t\tpoints: [\n\t\t\t\tnew Vector3(-450, 90, 80),\n\t\t\t\tnew Vector3(-450, 0, 80),\n\t\t\t],\n\t\t\tsteps: 2,\n\t\t},\n\t]\n\n\tfor (let i = 0; i < riverParams.length; i++) {\n\t\triver.push( new Water(riverParams[i].points, riverParams[i].steps) )\n\t}\n\n\triver.map(riverPart => islands.add(riverPart.mesh))\n\n\n\t// lamp posts\n\tlet lampPosts = []\n\n\tconst lampPostParams = [\n\t\t{ x: -215, y: 650, z: -185, ry: 0 },\n\t\t{ x: -215, y: 650, z: 185, ry: Math.PI },\n\t\t{ x: 180, y: 250, z: -175, ry: -Math.PI / 4 },\n\t\t{ x: 170, y: -150, z: 400, ry: -Math.PI / 2 },\n\t]\n\n\tfor (let i = 0; i < lampPostParams.length; i++) {\n\t\tconst lampPost = new LampPost();\n\n\t\tlampPost.mesh.position.set(\n\t\t\tlampPostParams[i].x,\n\t\t\tlampPostParams[i].y,\n\t\t\tlampPostParams[i].z,\n\t\t)\n\n\t\tlampPost.mesh.rotation.y += lampPostParams[i].ry\n\n\t\tlampPosts.push( lampPost )\n\t}\n\n\tislands.add(\n\t\t...(lampPosts.map( lampPost => lampPost.mesh ))\n\t)\n\n\n\t// final\n\tscene.add(\n\t\themisphereLight,\n\t\tambientLight,\n\t\tsunLight,\n\t\t// sunLightHelper, // temp\n\t\tislands,\n\t\tzeppelin.mesh,\n\t);\n\t// isometric view\n\tscene.rotation.x = Math.PI / 4;\n\tscene.rotation.y = - Math.PI / 4;\n\n\n\t// animation\n\tconst clock = new Clock()\n\tlet delta\n\n\n\t// mouse position\n\tconst mousePos = {\n\t\tx: WIDTH / 2, \t// default\n\t\ty: HEIGHT / 2,\n\t\tnX: 0,\t\t\t// normalized\n\t\tnY: 0,\n\t}\n\tdocument.addEventListener('mousemove', event => {\n\t\tmousePos.nX = -1 + (event.clientX / WIDTH) * 2\n\t\tmousePos.nY = 1 - (event.clientY / HEIGHT) * 2\n\t})\n\n\n\t// mobile gyroscope\n\tlet gyroscope = {\n\t\tx: 0,\n\t\ty: 0,\n\t}\n\n\tlet checkOrientation = ({ beta, gamma }) => {\n\t\tgyroscope.x = clamp(-90, beta, 90) || 0\n\t\tgyroscope.y = clamp(-45, gamma, 45) || 0\n\n\t\tmousePos.nY = -1 + (gyroscope.x / 90) * 2\n\t\tmousePos.nX = 1 - (gyroscope.y / 45) * 2\n\t}\n\n\tif (typeof DeviceOrientationEvent.requestPermission === 'function') {\n\t\tDeviceOrientationEvent.requestPermission()\n\t\t\t.then(permissionState => {\n\t\t\t\tif (permissionState === 'granted')\n\t\t\t\t\twindow.addEventListener('deviceorientation', checkOrientation)\n\t\t\t\t})\n\t\t\t.catch(console.log)\n\t} else window.addEventListener('deviceorientation', checkOrientation)\n\n\t// when all loaded\n\t// time\n\tconst time = new Time()\n\tlet hours = +time.getHours()\n\n\tlet updateLights = hours => {\n\t\tif (hours >= breakpoints[0] && hours < breakpoints[1]) {\n\t\t\tcontainer.className = 'sunrise'\n\t\t\tsetLights('sunrise')\n\t\n\t\t} else if (hours >= breakpoints[1] && hours < breakpoints[2]) {\n\t\t\tcontainer.className = 'midday'\n\t\t\tsetLights('midday')\n\t\n\t\t} else if (hours >= breakpoints[2] && hours < breakpoints[3]) {\n\t\t\tcontainer.className = 'sunset'\n\t\t\tsetLights('sunset')\n\n\t\t} else {\n\t\t\tcontainer.className = 'midnight'\n\t\t\tmaterials.line.color.setHex(0x111111)\n\t\t\tsetLights('midnight')\n\t\t}\n\t}\n\tupdateLights(hours)\n\n\n\t// vane\n\tconst vane = middleIsland.windvane.vane\n\n\t// animation\n\tlet easing = .05\n\tlet i = 0\n\n\tlet draw = () => {\n\n\t\tdelta = clock.getDelta()\n\n\t\t// fans\n\t\tmiddleIsland.fans[0].rotate(5 * delta)\n\t\tmiddleIsland.fans[1].rotate(6 * delta)\n\n\t\ttopIsland.fans[0].rotate(-2 * delta)\n\t\ttopIsland.fans[1].rotate(-4 * delta)\n\n\n\t\t// windvane\n\t\tmiddleIsland.windvane.rotateFan(delta)\n\n\n\t\t// waves\n\t\triver[0].moveWaves()\n\t\triver[1].moveWaves()\n\t\triver[2].moveWaves()\n\n\t\tzeppelin.fans[0].rotate(20 * delta)\n\t\tzeppelin.fans[1].rotate(21 * delta)\n\t\tzeppelin.fans[2].rotate(19 * delta)\n\t\tzeppelin.fans[3].rotate(22 * delta)\n\t\tzeppelin.cabine.turbines[0].rotate(.25 * delta)\n\t\tzeppelin.cabine.turbines[1].rotate(.25 * delta)\n\n\t\tzeppelin.mesh.position.y += Math.sin(i * Math.PI)\n\t\tislands.position.y += Math.cos(i * Math.PI) / 2\n\n\t\tvane.rotation.y += Math.cos(i * Math.PI) * easing / 10\n\t\t\n\t\ti += .01\n\n\t\tscene.rotation.x += (-mousePos.nY * (Math.PI / 10) + (Math.PI / 4) - scene.rotation.x) * easing\n\t\tscene.rotation.y += (mousePos.nX * (Math.PI / 8) - (Math.PI / 4) - scene.rotation.y) * easing\n\n\t\trenderer.render(scene, camera)\n\t}\n\n\tlet rafId = null\n\tlet update = () => {\n\t\trafId = requestAnimationFrame(update)\n\t\tdraw()\n\t}\n\n\tlet start = () => {\n\t\tupdate()\n\t}\n\n\tlet stop = () => {\n\t\tcancelAnimationFrame(rafId)\n\t}\n\n\t// dat.GUI\n\tlet gui = new dat.GUI({\n\t\tautoplace: false,\n\t\thideable: false,\n\t})\n\tgui.closed = true\n\n\tconst guiContainer = document.getElementById('gui')\n\tguiContainer.appendChild(gui.domElement)\n\n\t// let directionalLight = gui.addFolder('scene light');\n\t// directionalLight.add(scene.children[2].position, 'x', (- 1000), 1000);\n\t// directionalLight.add(scene.children[2].position, 'y', (- 1000), 1000);\n\t// directionalLight.add(scene.children[2].position, 'z', (- 1000), 1000);\n\t// directionalLight.open();\n\n\tlet params = {\n\t\tcameraControls: true,\n\t\tisOverride: false,\n\t\tsunrise: \t() => updateLights(7),\n\t\tmidday: \t() => updateLights(11),\n\t\tsunset: \t() => updateLights(19),\n\t\tmidnight: \t() => updateLights(0),\n\t}\n\n\t// gui.add(params, 'cameraControls').onChange(() => {\n\t// \tcontrols.enabled = (params.cameraControls) ? true : false\n\t// }).name('camera controls');\n\n\t// gui.add(params, 'isOverride').onChange(() => {\n\t// \tscene.overrideMaterial = (params.isOverride) ? materials.override : false;\n\t// }).name('wireframe');\n\t\n\tlet dayTimeGUI = gui.addFolder('daytime')\n\tdayTimeGUI.add(params, 'sunrise')\n\tdayTimeGUI.add(params, 'midday')\n\tdayTimeGUI.add(params, 'sunset')\n\tdayTimeGUI.add(params, 'midnight')\n\tdayTimeGUI.open()\n\n\t// console.log(scene);\n\t// console.log(renderer.info);\n\n\t// export scene\n\tif (process.env.NODE_ENV === 'development') {\n\n\t\tconsole.log('press s to save scene to json')\n\n\t\tdocument.addEventListener('keypress', ({ keyCode }) => {\n\t\t\tif (keyCode === 115) {\n\t\t\t\tlet json = JSON.stringify(scene.toJSON())\n\n\t\t\t\tlet blob = new Blob([json], { type: 'application/json' })\n\n\t\t\t\tlet url  = URL.createObjectURL(blob)\n\t\t\n\t\t\t\tlet a = document.createElement('a')\n\t\t\t\ta.download = 'scene.json'\n\t\t\t\ta.href = url\n\t\t\t\ta.textContent = 'Download scene.json'\n\t\t\n\t\t\t\ta.click()\n\t\t\t}\n\t\t})\n\t}\n\n\treturn { draw, start, stop }\n}\n\nexport default init","import styles from '@/styles/main.scss'\n\nimport init from '@/modules/init'\nlet { draw, start, stop } = init()\n\nlet isIframe = (() => {\n\ttry {\n\t\treturn window.self !== window.top\n\t} catch (e) {\n\t\treturn true\n\t}\n})()\n\nif (isIframe) {\n\tdraw()\n\n\tlet trusted = [\n\t\t'http://localhost:8080',\n\t\t'https://nextgtrgod.github.io',\n\t]\n\n\twindow.addEventListener('message', e => {\n\t\tif (!trusted.includes(e.origin)) return\n\n\t\tswitch (e.data) {\n\t\t\tcase 'start':\n\t\t\t\tstart()\n\t\t\t\tbreak;\n\t\t\tcase 'stop':\n\t\t\t\tstop()\n\t\t\t\tbreak;\n\t\t}\n\t})\n} else {\n\tstart()\n\n\tlet controls = process.env.NODE_ENV === 'development'\n\tlet gui = document.getElementById('gui')\n\n\tif (controls) gui.classList.add('visible')\n\t\n\tdocument.addEventListener('keyup', ({ keyCode }) => {\n\t\tif (keyCode !== 72) return\n\t\tgui.classList.toggle('visible')\n\t})\n\tconsole.log('press h to show controls')\n}\n\ndocument.body.classList.add('loaded')\n"],"sourceRoot":""}